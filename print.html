<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The &#x27;flow&#x27; Guide</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="A guide to &#x27;flow&#x27;: what it is and how to use it">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="book_intro.html">Intro</a></li><li class="chapter-item expanded affix "><li class="part-title">Introduction to flow</li><li class="chapter-item expanded "><a href="docs/introduction/what_is_flow.html"><strong aria-hidden="true">1.</strong> What is flow?</a></li><li class="chapter-item expanded "><a href="docs/introduction/tenets.html"><strong aria-hidden="true">2.</strong> Tenets of flow</a></li><li class="chapter-item expanded "><a href="docs/introduction/structure.html"><strong aria-hidden="true">3.</strong> Project Components and Structure</a></li><li class="chapter-item expanded "><a href="docs/introduction/inspirations.html"><strong aria-hidden="true">4.</strong> The Inspirations for flow</a></li><li class="chapter-item expanded "><a href="docs/introduction/non_inspirations.html"><strong aria-hidden="true">5.</strong> Non-Inspirations</a></li><li class="chapter-item expanded "><a href="docs/introduction/status.html"><strong aria-hidden="true">6.</strong> Status</a></li><li class="chapter-item expanded "><a href="docs/introduction/flow_programming.html"><strong aria-hidden="true">7.</strong> Flow Programming</a></li><li class="chapter-item expanded affix "><li class="part-title">Your First Flow</li><li class="chapter-item expanded "><a href="docs/first_flow/first_flow.html"><strong aria-hidden="true">8.</strong> Your First Flow</a></li><li class="chapter-item expanded "><a href="docs/first_flow/understanding.html"><strong aria-hidden="true">9.</strong> Understanding it</a></li><li class="chapter-item expanded "><a href="docs/first_flow/implementation.html"><strong aria-hidden="true">10.</strong> Real Implementation</a></li><li class="chapter-item expanded "><a href="docs/first_flow/step-by-step.html"><strong aria-hidden="true">11.</strong> Step-by-Step</a></li><li class="chapter-item expanded "><a href="docs/first_flow/debugging.html"><strong aria-hidden="true">12.</strong> Debugging your first flow</a></li><li class="chapter-item expanded affix "><li class="part-title">Defining Flows</li><li class="chapter-item expanded "><a href="docs/describing/definition_overview.html"><strong aria-hidden="true">13.</strong> Defining flows</a></li><li class="chapter-item expanded "><a href="docs/describing/names.html"><strong aria-hidden="true">14.</strong> Names</a></li><li class="chapter-item expanded "><a href="docs/describing/ios.html"><strong aria-hidden="true">15.</strong> Flow IOs</a></li><li class="chapter-item expanded "><a href="docs/describing/process_references.html"><strong aria-hidden="true">16.</strong> Process References</a></li><li class="chapter-item expanded "><a href="docs/describing/function_definitions.html"><strong aria-hidden="true">17.</strong> Function Definitions</a></li><li class="chapter-item expanded "><a href="docs/describing/types.html"><strong aria-hidden="true">18.</strong> Types</a></li><li class="chapter-item expanded "><a href="docs/describing/connections.html"><strong aria-hidden="true">19.</strong> Connections</a></li><li class="chapter-item expanded "><a href="docs/describing/io_references.html"><strong aria-hidden="true">20.</strong> IO References</a></li><li class="chapter-item expanded "><a href="docs/describing/features.html"><strong aria-hidden="true">21.</strong> Complete Feature List</a></li><li class="chapter-item expanded "><a href="docs/describing/flow_libraries.html"><strong aria-hidden="true">22.</strong> Flow Libraries</a></li><li class="chapter-item expanded affix "><li class="part-title">Running Flows</li><li class="chapter-item expanded "><a href="flowrlib/README.html"><strong aria-hidden="true">23.</strong> flowr library</a></li><li class="chapter-item expanded "><a href="flowr/README.html"><strong aria-hidden="true">24.</strong> flowr runner</a></li><li class="chapter-item expanded "><a href="docs/running/running.html"><strong aria-hidden="true">25.</strong> Running flows</a></li><li class="chapter-item expanded "><a href="docs/running/flowc.html"><strong aria-hidden="true">26.</strong> flowc Command Line Arguments</a></li><li class="chapter-item expanded "><a href="docs/running/arguments.html"><strong aria-hidden="true">27.</strong> Passing command line arguments to flows</a></li><li class="chapter-item expanded "><a href="docs/running/context_selection.html"><strong aria-hidden="true">28.</strong> Selecting the Context file</a></li><li class="chapter-item expanded "><a href="docs/running/stdio.html"><strong aria-hidden="true">29.</strong> Standard Input and Output</a></li><li class="chapter-item expanded "><a href="docs/running/panics.html"><strong aria-hidden="true">30.</strong> Exceptions and Panics</a></li><li class="chapter-item expanded "><a href="flowr/src/context/args/args.html"><strong aria-hidden="true">31.</strong> Arg functions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="flowr/src/context/args/get.html"><strong aria-hidden="true">31.1.</strong> Arg get function</a></li></ol></li><li class="chapter-item expanded "><a href="flowr/src/context/file/file.html"><strong aria-hidden="true">32.</strong> File functions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="flowr/src/context/file/file_write.html"><strong aria-hidden="true">32.1.</strong> File Write function</a></li></ol></li><li class="chapter-item expanded "><a href="flowr/src/context/image/image.html"><strong aria-hidden="true">33.</strong> Image manipulation functions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="flowr/src/context/image/image_buffer.html"><strong aria-hidden="true">33.1.</strong> Image buffer</a></li></ol></li><li class="chapter-item expanded "><a href="flowr/src/context/stdio/stdio.html"><strong aria-hidden="true">34.</strong> Standard IO functions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="flowr/src/context/stdio/readline.html"><strong aria-hidden="true">34.1.</strong> Readline function</a></li><li class="chapter-item expanded "><a href="flowr/src/context/stdio/stdin.html"><strong aria-hidden="true">34.2.</strong> Standard Input function</a></li><li class="chapter-item expanded "><a href="flowr/src/context/stdio/stdout.html"><strong aria-hidden="true">34.3.</strong> Standard Output function</a></li><li class="chapter-item expanded "><a href="flowr/src/context/stdio/stderr.html"><strong aria-hidden="true">34.4.</strong> Standard Error function</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Debugging Flows</li><li class="chapter-item expanded "><a href="docs/debugging/debugger.html"><strong aria-hidden="true">35.</strong> The Debugger</a></li><li class="chapter-item expanded affix "><li class="part-title">The flowstdlib Standard Library</li><li class="chapter-item expanded "><a href="flowstdlib/README.html"><strong aria-hidden="true">36.</strong> flowstdlib</a></li><li class="chapter-item expanded "><a href="flowstdlib/control/control.html"><strong aria-hidden="true">37.</strong> control</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="flowstdlib/control/compare_switch/compare_switch.html"><strong aria-hidden="true">37.1.</strong> compare_switch</a></li><li class="chapter-item expanded "><a href="flowstdlib/control/index/index.html"><strong aria-hidden="true">37.2.</strong> index</a></li><li class="chapter-item expanded "><a href="flowstdlib/control/index_f.html"><strong aria-hidden="true">37.3.</strong> index_f</a></li><li class="chapter-item expanded "><a href="flowstdlib/control/join/join.html"><strong aria-hidden="true">37.4.</strong> join</a></li><li class="chapter-item expanded "><a href="flowstdlib/control/route/route.html"><strong aria-hidden="true">37.5.</strong> route</a></li><li class="chapter-item expanded "><a href="flowstdlib/control/select/select.html"><strong aria-hidden="true">37.6.</strong> select</a></li><li class="chapter-item expanded "><a href="flowstdlib/control/tap/tap.html"><strong aria-hidden="true">37.7.</strong> tap</a></li></ol></li><li class="chapter-item expanded "><a href="flowstdlib/data/data.html"><strong aria-hidden="true">38.</strong> data</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="flowstdlib/data/accumulate/accumulate.html"><strong aria-hidden="true">38.1.</strong> accumulate</a></li><li class="chapter-item expanded "><a href="flowstdlib/data/append/append.html"><strong aria-hidden="true">38.2.</strong> append</a></li><li class="chapter-item expanded "><a href="flowstdlib/data/buffer/buffer.html"><strong aria-hidden="true">38.3.</strong> buffer</a></li><li class="chapter-item expanded "><a href="flowstdlib/data/count/count.html"><strong aria-hidden="true">38.4.</strong> count</a></li><li class="chapter-item expanded "><a href="flowstdlib/data/duplicate/duplicate.html"><strong aria-hidden="true">38.5.</strong> duplicate</a></li><li class="chapter-item expanded "><a href="flowstdlib/data/duplicate_rows/duplicate_rows.html"><strong aria-hidden="true">38.6.</strong> duplicate_rows</a></li><li class="chapter-item expanded "><a href="flowstdlib/data/enumerate/enumerate.html"><strong aria-hidden="true">38.7.</strong> enumerate</a></li><li class="chapter-item expanded "><a href="flowstdlib/data/info/info.html"><strong aria-hidden="true">38.8.</strong> info</a></li><li class="chapter-item expanded "><a href="flowstdlib/data/multiply_row/multiply_row.html"><strong aria-hidden="true">38.9.</strong> multiply_row</a></li><li class="chapter-item expanded "><a href="flowstdlib/data/ordered_split/ordered_split.html"><strong aria-hidden="true">38.10.</strong> ordered_split</a></li><li class="chapter-item expanded "><a href="flowstdlib/data/remove/remove.html"><strong aria-hidden="true">38.11.</strong> remove</a></li><li class="chapter-item expanded "><a href="flowstdlib/data/sort/sort.html"><strong aria-hidden="true">38.12.</strong> sort</a></li><li class="chapter-item expanded "><a href="flowstdlib/data/split/split.html"><strong aria-hidden="true">38.13.</strong> split</a></li><li class="chapter-item expanded "><a href="flowstdlib/data/transpose/transpose.html"><strong aria-hidden="true">38.14.</strong> transpose</a></li><li class="chapter-item expanded "><a href="flowstdlib/data/zip/zip.html"><strong aria-hidden="true">38.15.</strong> zip</a></li></ol></li><li class="chapter-item expanded "><a href="flowstdlib/fmt/fmt.html"><strong aria-hidden="true">39.</strong> fmt</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="flowstdlib/fmt/reverse/reverse.html"><strong aria-hidden="true">39.1.</strong> reverse</a></li><li class="chapter-item expanded "><a href="flowstdlib/fmt/to_json/to_json.html"><strong aria-hidden="true">39.2.</strong> to_json</a></li><li class="chapter-item expanded "><a href="flowstdlib/fmt/to_string/to_string.html"><strong aria-hidden="true">39.3.</strong> to_string</a></li></ol></li><li class="chapter-item expanded "><a href="flowstdlib/math/math.html"><strong aria-hidden="true">40.</strong> math</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="flowstdlib/math/add/add.html"><strong aria-hidden="true">40.1.</strong> add</a></li><li class="chapter-item expanded "><a href="flowstdlib/math/compare/compare.html"><strong aria-hidden="true">40.2.</strong> compare</a></li><li class="chapter-item expanded "><a href="flowstdlib/math/divide/divide.html"><strong aria-hidden="true">40.3.</strong> divide</a></li><li class="chapter-item expanded "><a href="flowstdlib/math/multiply/multiply.html"><strong aria-hidden="true">40.4.</strong> multiply</a></li><li class="chapter-item expanded "><a href="flowstdlib/math/range.html"><strong aria-hidden="true">40.5.</strong> range</a></li><li class="chapter-item expanded "><a href="flowstdlib/math/range_split/range_split.html"><strong aria-hidden="true">40.6.</strong> range_split</a></li><li class="chapter-item expanded "><a href="flowstdlib/math/sequence.html"><strong aria-hidden="true">40.7.</strong> sequence</a></li><li class="chapter-item expanded "><a href="flowstdlib/math/sqrt/sqrt.html"><strong aria-hidden="true">40.8.</strong> sqrt</a></li><li class="chapter-item expanded "><a href="flowstdlib/math/subtract/subtract.html"><strong aria-hidden="true">40.9.</strong> subtract</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Sample flows</li><li class="chapter-item expanded "><a href="flowsamples/README.html"><strong aria-hidden="true">41.</strong> Samples Intro</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="flowsamples/args/DESCRIPTION.html"><strong aria-hidden="true">41.1.</strong> args</a></li><li class="chapter-item expanded "><a href="flowsamples/arrays/DESCRIPTION.html"><strong aria-hidden="true">41.2.</strong> arrays</a></li><li class="chapter-item expanded "><a href="flowsamples/factorial/DESCRIPTION.html"><strong aria-hidden="true">41.3.</strong> factorial</a></li><li class="chapter-item expanded "><a href="flowsamples/fibonacci/DESCRIPTION.html"><strong aria-hidden="true">41.4.</strong> fibonacci</a></li><li class="chapter-item expanded "><a href="flowsamples/hello-world/DESCRIPTION.html"><strong aria-hidden="true">41.5.</strong> hello-world</a></li><li class="chapter-item expanded "><a href="flowsamples/mandlebrot/DESCRIPTION.html"><strong aria-hidden="true">41.6.</strong> mandlebrot sample</a></li><li class="chapter-item expanded "><a href="flowsamples/matrix_mult/DESCRIPTION.html"><strong aria-hidden="true">41.7.</strong> matrix multiplication</a></li><li class="chapter-item expanded "><a href="flowsamples/pipeline/DESCRIPTION.html"><strong aria-hidden="true">41.8.</strong> pipeline</a></li><li class="chapter-item expanded "><a href="flowsamples/prime/DESCRIPTION.html"><strong aria-hidden="true">41.9.</strong> prime</a></li><li class="chapter-item expanded "><a href="flowsamples/primitives/DESCRIPTION.html"><strong aria-hidden="true">41.10.</strong> primitives</a></li><li class="chapter-item expanded "><a href="flowsamples/reverse-echo/DESCRIPTION.html"><strong aria-hidden="true">41.11.</strong> reverse-echo</a></li><li class="chapter-item expanded "><a href="flowsamples/router/DESCRIPTION.html"><strong aria-hidden="true">41.12.</strong> router</a></li><li class="chapter-item expanded "><a href="flowsamples/sequence/DESCRIPTION.html"><strong aria-hidden="true">41.13.</strong> sequence</a></li><li class="chapter-item expanded "><a href="flowsamples/sequence-of-sequences/DESCRIPTION.html"><strong aria-hidden="true">41.14.</strong> sequence-of-sequences</a></li><li class="chapter-item expanded "><a href="flowsamples/tokenizer/DESCRIPTION.html"><strong aria-hidden="true">41.15.</strong> tokenizer</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Developing flow</li><li class="chapter-item expanded "><a href="docs/developing/overview.html"><strong aria-hidden="true">42.</strong> Developing flow</a></li><li class="chapter-item expanded "><a href="docs/developing/prereqs.html"><strong aria-hidden="true">43.</strong> Pre-requisites</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="flowcore/README.html"><strong aria-hidden="true">43.1.</strong> flowcore</a></li><li class="chapter-item expanded "><a href="flowmacro/README.html"><strong aria-hidden="true">43.2.</strong> flowmacro</a></li><li class="chapter-item expanded "><a href="flowc/README.html"><strong aria-hidden="true">43.3.</strong> flowc</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="flowc/tests/test-flows/README.html"><strong aria-hidden="true">43.3.1.</strong> Test flows</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="flowc/tests/test-flows/hello-world/hello-world.html"><strong aria-hidden="true">43.3.1.1.</strong> hello-world</a></li><li class="chapter-item expanded "><a href="flowc/tests/test-flows/line-echo/line-echo.html"><strong aria-hidden="true">43.3.1.2.</strong> line-echo</a></li><li class="chapter-item expanded "><a href="flowc/tests/test-flows/print-args/print-args.html"><strong aria-hidden="true">43.3.1.3.</strong> print-args</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="docs/developing/make.html"><strong aria-hidden="true">44.</strong> Makefile targets</a></li><li class="chapter-item expanded "><a href="docs/developing/contributing.html"><strong aria-hidden="true">45.</strong> Ways to contribute</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="docs/developing/issues.html"><strong aria-hidden="true">45.1.</strong> Issues</a></li><li class="chapter-item expanded "><a href="docs/developing/prs.html"><strong aria-hidden="true">45.2.</strong> PRs</a></li><li class="chapter-item expanded "><a href="flowsamples/README.html"><strong aria-hidden="true">45.3.</strong> Developing a sample</a></li><li class="chapter-item expanded "><a href="docs/developing/ci.html"><strong aria-hidden="true">45.4.</strong> Continuous Integration Tests</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Internals of the flow Project</li><li class="chapter-item expanded "><a href="docs/internals/overview.html"><strong aria-hidden="true">46.</strong> Internals of flow</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="docs/internals/flow_loading.html"><strong aria-hidden="true">46.1.</strong> Flow Loading</a></li><li class="chapter-item expanded "><a href="docs/internals/flow_compiling.html"><strong aria-hidden="true">46.2.</strong> Flow Compiling</a></li><li class="chapter-item expanded "><a href="docs/internals/flow_execution.html"><strong aria-hidden="true">46.3.</strong> Flow Execution</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The &#x27;flow&#x27; Guide</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="welcome"><a class="header" href="#welcome">Welcome!</a></h1>
<p>Welcome to <code>flow</code>, a system for defining and running parallel, 
<a href="https://en.wikipedia.org/wiki/Dataflow_programming">dataflow programs</a> like this one:</p>
<p><img src="first.svg" alt="First flow" /></p>
<p>Page through this guide using the '&gt;' and '&lt;' buttons on the side of the page or navigating directly
to a section using the Table of Contents on the left.</p>
<p>The top-level sections are:</p>
<ul>
<li><a href="docs/introduction/what_is_flow.html">Introduction to Flow</a></li>
<li><a href="docs/first_flow/first_flow.html">Your First Flow</a></li>
<li><a href="docs/describing/definition_overview.html">Defining flows</a></li>
<li><a href="docs/running/running.html">Running flows</a></li>
<li><a href="flowr/README.html">The <code>flowr</code> runner</a></li>
<li><a href="docs/debugging/debugger.html">Debugging Flows</a></li>
<li><a href="flowstdlib/README.html">The Flow Standard Library</a></li>
<li><a href="flowsamples/README.html">Sample flows</a></li>
<li><a href="docs/developing/overview.html">Developing Flow</a></li>
<li><a href="docs/internals/overview.html">Internals of the Flow Project</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="what-is-flow"><a class="header" href="#what-is-flow">What is 'flow'</a></h2>
<p><code>flow</code> is a system for defining and running inherently parallel, data-dependency-driven 'programs'.</p>
<p>A <code>flow</code> is a program created by a description of interconnected and communicating <code>processes</code>.</p>
<p>A process can have zero or more inputs and produces zero or one output. They have no side-effects.
There is no shared-memory.</p>
<p>The interconnections between processes are explicit declarations of data dependencies between them.
i.e. what data is required for a process to be able to run, and what output it produces.</p>
<p>Thus a <code>flow</code> is inherently parallel, without any further need to express the parallelism of the described algorithm.</p>
<p>As part of describing the interconnections, I would like <code>flow</code> to be also visual, making the data dependencies visible
and directly &quot;author-able&quot;. Processes and sub-flows are interchangeable and nestable, so that higher
level programs can be constructed by combining primitive processes and nested 'flows', making flows reusable.</p>
<p>At the time of writing, I haven't been able to do the GUI for the visual creation, viewing, running and
debugging of flows - and flows are described in a textual intermediate format based on TOML. This format could
be used as the description format for a visual GUI though.</p>
<p>I don't consider it a &quot;programming language&quot; as the functionality of the program is created from the combination of many
low-level functions, that can be very fine grained and implemented in many programming languages (or even assembly, 
WebAssembly, LLVM-IR or something else). Most logic (control flow, loops) comes from how the processes are &quot;wired together&quot;
in 'flows'. I have chosen to implement my basic processes in 'flowstdlib' and the 'flowr' run-time in rust (but they could 
be in other languages).</p>
<p>I don't consider it (or the flow description format) a DSL. The file format is chosen for describing a flow in text.
The file format is not important, providing it can describe the flow.
I chose TOML as there was good library support for parsing it in rust and it's a bit easier on the eyes than writing
JSON. I have made provisions for the flow description to be able to be in other formats and even to be able to mix and 
combine descriptions in multiple formats. I started a JSON one but haven't had the need to implement it as 
TOML is working fine so far.</p>
<p>Q. Is it high-level or low-level? </p>
<p>A. &quot;Well...yes&quot;. </p>
<p>The level of granularity chosen for the implementation of the primitive processes that flows are built from is arbitrary. 
A process could be as simple as adding two numbers, or it could implement a complex algorithm.</p>
<p>A number of simple primitive processes can be combined together into a flow (which is also a process) and hence appear
as a complex process to it's users. Or it could be a complex primitive process, implementing the entire algorithm in
code. The users of the process (complex primitive process, or a flow process built from multiple others) should not
have to know how it is implemented. They see the definition of inputs and outputs and use it indistinctly.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="fundamental-tenets-of-flow"><a class="header" href="#fundamental-tenets-of-flow">Fundamental tenets of 'flow'?</a></h2>
<p>The 'tenets', or fundamental design principles, of <code>flow</code> include:</p>
<ul>
<li>No Global shared memory</li>
<li>Processes have no side-effects (exception is IO processes which I'll describe later)</li>
<li>Encapsulation - complexity of a Process is hidden inside it's definition and you don't need to know it's implementation
to know how to use it. In fact a Process can be a primitive process implemented as a single function in code or an 
entire sub-flow containing many sub-layers</li>
<li>Re-usability - enabled by encapsulation. A well defined process can be used in many other flows via references to it.</li>
<li>Portability - the intention is that the run-time can run on many platforms (and the libraries have been written to
be able to compile to WASM and run in a browser also) and that implementations of primitive Processses supplied by
the user can be compiled to WASM once, then distributed with the flow and run by any of the run-times</li>
<li>Polyglot - although the compiler is written in one language, others versions could be written in other languages. 
There is only one run-time written at the moment, but others could be written in other languages to run flows compiled
by any compiler. Process implementations supplied with a flow can be written in any language that can compile to WASM, 
so it can then be distributed with the flow and then loaded and run by any run-time implementation.</li>
<li>Functional Composition/Decomposition - a problem can be decomposed into a number of communicating processes, and those in 
turn can be decomposed and so on down in a hierarchy of processes until primitive processes are used. Thus the 
implementation is composed of a number of processes, some of which maybe reused from elsewhere and some specific to
the problem being solved.</li>
<li>Data Composition/Decomposition - data that flows between processes can be defined at a high-level, but consist of a 
complex structure or multiple levels or arrays of data, and processes and sub-processes can select sub-elements as
input for their processing.</li>
<li>Inherently parallel - this is a design goal that still needs a lot of work, but the idea is that the flow describes
the algorithm to execute via processes and connections between them and order of execution (obeying data dependencies
and dat aflow rules) falls out from the definition and can be executed in series (one process at a time) or parallel
(multiple processes executing at a time)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="project-components-and-structure"><a class="header" href="#project-components-and-structure">Project Components and Structure</a></h2>
<p>Here is a summary of the project components, their purpose and a link to their <code>README.md</code>:</p>
<ul>
<li><a href="docs/introduction/../../flowcore/README.html">flowcore</a> - A set of core structs and traits used by <code>flowr</code> and <code>flowc</code> plus code 
to fetch content from file/http and resolve library (lib://) references.</li>
<li><a href="docs/introduction/../../flowmacro/README.html">flowmacro</a> - A macro used to help write function implementation code that compile natively
and to wasm</li>
<li><a href="docs/introduction/../../flowc/README.html">flowc</a> - The <code>flowc</code> flow compiler binary is a CLI built around <code>flowclib</code> that 
takes a number of command line arguments and source files or URLs and compiles the flow or library referenced.
<ul>
<li><code>flowclib</code> is the library for compiling flow program and library definitions from toml 
files, producing generated output projects that can be run by <code>flowr</code>.</li>
</ul>
</li>
<li><a href="docs/introduction/../../flowr/README.html">flowrlib</a> - The flow runner library that loads and executes compiled flows.</li>
<li><a href="docs/introduction/../../flowr/README.html">flowr</a> - The <code>flowr</code> flow runner binary that can be used to run and debug </li>
<li>flows compiled with a flow compiler such as <code>flowc</code>.</li>
<li><a href="docs/introduction/../../flowstdlib/README.html">flowstdlib</a> - the flow &quot;standard library&quot; which contains a set of functions that can be 
used by flows being defined by the user</li>
<li><a href="docs/introduction/../../flowsamples/README.html">samples</a> - A set of sample flows</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="the-inspirations-for-flow"><a class="header" href="#the-inspirations-for-flow">The Inspirations for 'flow'</a></h2>
<p>I have had many sources of inspiration in this area over the past three decades, and without realizing it they started to coalesce 
in my head and seemingly unrelated ideas from very different projects started to come together to form what I eventually called 'flow'
and started to work on.</p>
<p>I will describe the specific inspirations in more detail in later sections of this guide.</p>
<p>The impetus to actually implement something, instead of just thinking about it, came over a year ago as a way to learn 
some rust (and later adding WebAssembly to the mix).</p>
<ul>
<li>The Inmos transputer chip and it's Occam parallel programming language (which I studied at University in the '80's)</li>
<li>Structured Analysis (and Design) from my work with it in HP the '80s!</li>
<li>UNIX pipes</li>
<li>Trace based compiler instruction scheduling work done at MultiFlow and later HP by Josh Fisher, Paolo Faraboschi and others</li>
<li>Amoeba distributed OS by Andrew Tannenbaum that made a collaborating network of computers appear as one to the user of a &quot;Workstation&quot;</li>
<li>Yahoo! Pipes</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="non-inspirations"><a class="header" href="#non-inspirations">Non-Inspirations</a></h2>
<p>There are a number of things that you might suspect were part of my set of inspirations
for creating 'flow', or maybe you think I even copied the idea from them, but that in fact
(you'll have to trust me on this one) is not true.</p>
<p>I didn't study Computer Science, and if I had I may well have been exposed to some of these
subjects a long-time ago. That would probably have saved me a lot of time.</p>
<p>But, then I would have been implementing someone else's ideas and not (what I thought were)
my own. Think of all the satisfaction I would have lost out on while re-inventing thirty to 
forty year-old ideas!</p>
<p>While implementing the first steps of 'flow' I started to see some materials come up in
my Internet searches, that looked like they could be part of a theory of the things I
was struggling with. The Main one would be Hoare's 1976 paper on the &quot;Theory of
Communicating Sequential Processes&quot; (or CSP for short).</p>
<p>It turns out some of that based work was the basis for some of my inspirations (e.g.
Inmos Transputer and Occam language), unbeknownst to me.</p>
<p>But I decided to deliberately ignore them as I worked out my first thoughts, did
the initial implementation and got some simple examples up and running!</p>
<p>Later, I looped back and read some papers, and confirmed most of my conjectures. </p>
<p>I got a bit bored with the algebra approach to it (and related papers) though and didn't
read or learn too much.</p>
<p>One Hoare paper refers more to a practical implementation, and does hit on a number of the
very subjects I was struggling with, such as the buffering (or not) of data on &quot;data flows&quot;
between functions (or processes in his terms).</p>
<p>Once I progress some more, I will probably go back and read more of these papers and books and 
find solutions to the problems I have struggled to work out on my own - but part of the
purpose of this project for me is the intellectual challenge to work them out for myself, as 
best as I can.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="status"><a class="header" href="#status">Status</a></h2>
<p>The semantics of flows, processes and connections along with the implementation of the <code>flowc</code> compiler, <code>flowr</code> 
runner, <code>context</code> functions and the <code>flowstdlib</code> library has allowed for the 
creation of a set of example flows that execute as expected.</p>
<p>There has pretty good overall test coverage (&gt; 82%) that allows for safer refactoring.</p>
<p>The docs are reasonably extensive but a bit out of date in places, but I have issues created to cover most of the most
significant docs improvements needed.</p>
<p>The project continues to evolve in <a href="https://github.com/andrewdavidmackenzie">the flow repo</a> with myself as the 
only contributor.</p>
<p>I moved some GUI/IDE experimentation into a separate repo that uses the <code>flowclib</code>  and <code>flowrlib</code> libs from here,
and that is the biggest area needing work in order to showcase <code>flow</code> and make it more visual and easy to follow
for folks.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="flow-programming"><a class="header" href="#flow-programming">Flow Programming</a></h2>
<p>Flows are &quot;programmed&quot; by describing a network of &quot;functions&quot; that are connected by &quot;data flows&quot;.</p>
<p>In flow, there are some specific semantics about how the data flows and function invocation
work, but the basics are pretty simple.</p>
<p>A flows may have zero or more inputs, a set of outputs (which can be destructured into component parts), 
values (initialized or not), functions, and sub-flows.</p>
<p>Hence:</p>
<p><code>flow = [input] + [output] + [flow] + [values] + [functions]</code></p>
<p>To Be Extended....</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="first-flow"><a class="header" href="#first-flow">First flow</a></h2>
<p>Below is a schematic diagram of a 'flow'. </p>
<p>Without knowing anything about 'flow' and it's detailed semantics 
can you guess what this flow does when executed and what the output to STDOUT will be?
<img src="docs/first_flow/../../first.svg" alt="First flow" /></p>
<p>The next section reveals the answer and walks you thru it.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="understanding-a-simple-flow"><a class="header" href="#understanding-a-simple-flow">Understanding a simple flow</a></h2>
<p>The flow shown in the image in the previous section is a fibonacci series generator.</p>
<p>Here is a simple explanation of what's involved and how it runs. </p>
<p>You can find a complete description of the 'flow' semantics used, and others, in the next 
section <a href="docs/first_flow/../describing/definition_overview.html">Describing Flows</a></p>
<h3 id="top-level---context"><a class="header" href="#top-level---context">Top Level - Context</a></h3>
<p>The top-level, or root, of a flow is called the Context. This term is stolen from 
&quot;Structured Analysis&quot; (see <a href="docs/first_flow/../introduction/inspirations.html">Inspirations section</a>) and its
purpose is to define what the interaction with the surrounding execution environment is.</p>
<p>Other flows can be included under this level, via references to separate flow description files,
to enable encapsulation and flow reuse.</p>
<p>In this example there is no sub-flow included (for the sake of simplicity).</p>
<h3 id="interaction-with-the-execution-environment"><a class="header" href="#interaction-with-the-execution-environment">Interaction with the execution environment</a></h3>
<p>The top-level defines what the interaction with the surrounding execution environment is,
such as <code>stdout</code>, or other inputs/outputs provided by the flow runtime being used.</p>
<p>The only interaction with the execution environment in this example is the use of <code>stdout</code>.</p>
<p><code>stdout</code> (Standard Output) is a function defined in the <code>context</code>, to which output can be sent for display.</p>
<p>When executing a flow using <code>flowc</code>, <code>stdout</code> is sent to the standard output of 
the process running <code>flowc</code>, hence it is displayed in the terminal if running from the command line.</p>
<p>Other runtime environments (e.g. The experimental <code>flowide-gtk</code> graphical IDE that you can find in
a separate project in GitHuib) may display the output in some other way.</p>
<h3 id="functions"><a class="header" href="#functions">Functions</a></h3>
<p>This flow uses two functions: <code>stdout</code> from <code>context</code> as described above, plus <code>add</code> from the flow library
called <code>flowstdlib</code> to add two integers together.</p>
<h3 id="connections"><a class="header" href="#connections">Connections</a></h3>
<p>Connections take the output of a function and send it to the input of another. When all the inputs of a function
have a value the function can run, and produce outputs for others (or not produce outputs, as in the case of the 
impure <code>stdout</code> function).</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="real-implementation"><a class="header" href="#real-implementation">Real Implementation</a></h1>
<p>This flow exists as a sample in the <code>samples/fibonacci</code> folder and is written to be as simple as possible,
not using nested flows or similar.</p>
<h3 id="running-the-corresponding-sample"><a class="header" href="#running-the-corresponding-sample">Running the corresponding sample</a></h3>
<p>You can run this first flow and observe its output from the terminal, while in the project root folder:</p>
<pre><code class="language-shell script">&gt; cargo run -- flowsamples/fibonacci
</code></pre>
<p><code>flowc</code> will compile the flow definition (<code>root.toml</code>) and generate the <code>manifest.json</code> manifest which is 
then run using <code>flowr</code>.
<code>flowr</code> is a flow runner and as such supplies implementations for all the <code>context</code> functions (e.g. <code>stdout</code>).</p>
<p>The flow produces a fibonacci series:</p>
<pre><code class="language-shell script">&gt; cargo run -p flowc -- flowsamples/fibonacci
   Compiling flowstdlib v0.6.0 (/Users/andrew/workspace/flow/flowstdlib)
    Finished dev [unoptimized + debuginfo] target(s) in 1.75s
     Running `target/debug/flowc flowsamples/first`
1
2
3
5
8
...... lines deleted ......
2880067194370816120
4660046610375530309
7540113804746346429
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="step-by-step"><a class="header" href="#step-by-step">Step-by-Step</a></h2>
<p>Execution is in terms of Functions. Values are in fact a specific implementation of a
Function, as Values have to store values, unlike functions.</p>
<h3 id="init"><a class="header" href="#init">Init</a></h3>
<p>The list of Functions is loaded and all are initialized. 
This includes making the initial values available (just once) at 
the inputs of any values that have initial values specified in the flow description.</p>
<p>Status (ready to run, pending inputs, blocked etc) of all functions is set based on availability of their inputs and 
not being blocked from sending its output.</p>
<h3 id="execution-loop"><a class="header" href="#execution-loop">Execution Loop</a></h3>
<p>In general, the execution loop takes the next function that is in the ready state 
(has all its input values available, and is not blocked from sending its output by other functions) and runs it.</p>
<p>That consumed the inputs and sends the output value to all functions connected to the output. That makes that input
available to the other function connected to the output, and it may make that other function ready to run.</p>
<p>When there are no more functions in the ready to run state, then execution has terminated and the flow ends.</p>
<h3 id="specific-sequence-for-this-example"><a class="header" href="#specific-sequence-for-this-example">Specific Sequence for this example</a></h3>
<h4 id="init-1"><a class="header" href="#init-1">Init:</a></h4>
<ul>
<li>Initial values of 1 are made available in the inputs of &quot;HEAD&quot; and &quot;HEAD-1&quot; values.</li>
<li>HEAD-1 has input (1) available and is not blocked from sending its outputs, so it is made ready to run.</li>
<li>HEAD has input (1) available and is not blocked from sending its outputs, so it is made ready to run.</li>
<li>STDOUT does not have an input value available so it is not &quot;ready&quot;</li>
<li>SUM does not have its inputs available so it is not &quot;ready&quot;</li>
</ul>
<h4 id="loop-starts"><a class="header" href="#loop-starts">Loop Starts</a></h4>
<p>ReadyList = HEAD-1(1), HEAD(1)</p>
<p>Next function with status &quot;ready&quot; is run:</p>
<ul>
<li>HEAD-1 is run with input 1
<ul>
<li>HEAD-1 makes the value 1 available on its output (to STDOUT and SUM)
<ul>
<li>HEAD-1 is now blocked from running again until its output to SUM is free</li>
<li>STDOUT has all inputs available (from &quot;HEAD-1&quot;) so is made &quot;ready&quot;</li>
<li>SUM(1,_) only has one of its inputs available, so it is not made &quot;ready&quot;</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ReadyList = HEAD(1), STDOUT(1)</p>
<p>Next function with status &quot;ready&quot; is run:</p>
<ul>
<li>&quot;HEAD&quot; is run with input 1
<ul>
<li>This updates its value and makes the value 1 available on its outputs (to HEAD-1 and SUM)
<ul>
<li>SUM(1,1) now has both inputs available (from HEAD and HEAD-1) so it is made &quot;function&quot;</li>
<li>HEAD-1(1) has an input value available (from HEAD, but it cannot run as its output is blocked by SUM, 
so it is &quot;blocked on output&quot; and not &quot;ready&quot;.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ReadyList = STDOUT(1), SUM(1,1)</p>
<p>Next function with status &quot;ready&quot; is run:</p>
<ul>
<li>&quot;STDOUT&quot; runs with input 1. It prints &quot;1&quot; on the stdout of the run-time.</li>
</ul>
<blockquote>
<p>1</p>
</blockquote>
<p>ReadyList = SUM(1,1)</p>
<p>Next function with status &quot;ready&quot; is run:</p>
<ul>
<li>&quot;SUM&quot; runs with inputs 1 and 1. It produces the value 2 on its output (to HEAD)
<ul>
<li>SUM running consumes its input and unblocks HEAD-1(1) from running</li>
<li>HEAD has its input available so is made &quot;ready&quot; with input 2</li>
</ul>
</li>
</ul>
<p>ReadyList = HEAD-1(1), HEAD(2)</p>
<p>Next function with status &quot;ready&quot; is run:</p>
<ul>
<li>HEAD-1 is run with input 1. It produces 1 on its output (to STDOUT and SUM)
<ul>
<li>STDOUT(1) has its input available so is made &quot;ready&quot;</li>
<li>SUM(1, _) only has one input available and so is not &quot;ready&quot;</li>
</ul>
</li>
</ul>
<p>ReadyList = HEAD(2), STDOUT(1)</p>
<p>Next function with status &quot;ready&quot; is run:</p>
<ul>
<li>&quot;HEAD&quot; is run with input 2. It produces 2 on its output (to HEAD-1 and SUM)
<ul>
<li>SUM(1,2) is made &quot;ready&quot;</li>
<li>HEAD-1(2) is blocked on sending by SUM</li>
</ul>
</li>
</ul>
<p>ReadyList = STDOUT(1), SUM(1,2)</p>
<p>Next function with status &quot;ready&quot; is run:</p>
<ul>
<li>&quot;STDOUT&quot; runs with input 1. It prints &quot;1&quot; on the stdout of the run-time.</li>
</ul>
<blockquote>
<p>1</p>
</blockquote>
<p>ReadyList = SUM(1,2)</p>
<p>Next function with status &quot;ready&quot; is run:</p>
<ul>
<li>SUM runs with inputs 1 and 2. It produces the value 3 on its output (to HEAD)
<ul>
<li>HEAD-1(2) has its output unblocked by SUM and so is made &quot;ready&quot;</li>
<li>HEAD(3) has its input available so is made &quot;ready&quot;</li>
</ul>
</li>
</ul>
<p>ReadyList = HEAD-1(2), HEAD(3)</p>
<ul>
<li>HEAD-1(2) is run. It produces 2 on its output (to STDOUT and SUM)
<ul>
<li>STDOUT(2) has its input avaialble so is made &quot;ready&quot;</li>
<li>SUM(2, _) lacks an input and is not ready</li>
</ul>
</li>
</ul>
<p>ReadyList = HEAD(3), STDOUT(2)</p>
<ul>
<li>HEAD(3) is run. It produces 3 on its output (to HEAD-1 and SUM)
<ul>
<li>SUM(2, 3) is made &quot;ready&quot;</li>
<li>HEAD-1(3) is blocked on SUM so not &quot;ready&quot;</li>
</ul>
</li>
</ul>
<p>ReadyList = STDOUT(2), SUM(2,3), HEAD-1(3)</p>
<p>Next function with status &quot;ready&quot; is run:</p>
<ul>
<li>STDOUT(2)) runs. It prints &quot;2&quot; on the stdout of the run-time.</li>
</ul>
<blockquote>
<p>2</p>
</blockquote>
<p>ReadyList = SUM(2,3)</p>
<p>Next function with status &quot;ready&quot; is run:</p>
<ul>
<li>SUM(2,3) is run. It produces the value 5 on its output (to HEAD)
<ul>
<li>HEAD-1(3) has its output unblocked by SUM and so is made &quot;ready&quot;</li>
<li>HEAD(5) has its input available so is made &quot;ready&quot;</li>
</ul>
</li>
</ul>
<p>ReadyList = HEAD-1(3), HEAD(5)</p>
<p>Next function with status &quot;ready&quot; is run:</p>
<ul>
<li>HEAD-1(3) is run. It produces 3 on its output (to STDOUT and SUM)
<ul>
<li>STDOUT(3) has its input avaialble so is made &quot;ready&quot;</li>
<li>SUM(3, _) lacks an input and is not ready</li>
</ul>
</li>
</ul>
<p>ReadyList = HEAD(5), STDOUT(3)</p>
<p>Next function with status &quot;ready&quot; is run:</p>
<ul>
<li>HEAD(5) is run. It produces 5 on its output (to HEAD-1 and SUM)
<ul>
<li>SUM(3, 5) is made &quot;ready&quot;</li>
<li>HEAD-1(5) is blocked on SUM so not &quot;ready&quot;</li>
</ul>
</li>
</ul>
<p>ReadyList = STDOUT(3), SUM(3,5)</p>
<p>Next function with status &quot;ready&quot; is run:</p>
<ul>
<li>STDOUT(3)) runs. It prints &quot;3&quot; on the stdout of the run-time.</li>
</ul>
<blockquote>
<p>3</p>
</blockquote>
<p>and so on, and so forth.... producing a fibonacci series on the standard output of the run-time:</p>
<blockquote>
<p>1, 1, 2, 3, 5, 8 ...</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h2 id="debugging-your-first-flow"><a class="header" href="#debugging-your-first-flow">Debugging your first flow</a></h2>
<h3 id="command-line-options-to-flowc"><a class="header" href="#command-line-options-to-flowc">Command line options to <code>flowc</code></a></h3>
<p>When running <code>flowc</code> using <code>cargo run -p flowc</code> you should add <code>--</code> to mark the end of the options passed to cargo, 
and the start of the options passed to <code>flowc</code></p>
<p>You can see what they are using <code>--help</code> producing output similar to this:</p>
<pre><code class="language-bash">cargo run -p flowc -- --help                         
    Finished dev [unoptimized + debuginfo] target(s) in 0.12s
     Running 'target/debug/flowc --help'
flowc 0.8.8

USAGE:
    flowc [FLAGS] [OPTIONS] [--] [ARGS]

FLAGS:
    -d, --dump        Dump the flow to .dump files after loading it
    -z, --graphs      Create .dot files for graph generation
    -h, --help        Prints help information
    -l, --lib         Compile a flow library
    -p, --provided    Provided function implementations should NOT be compiled from source
    -s, --skip        Skip execution of flow
    -g, --symbols     Generate debug symbols (like process names and full routes)
    -V, --version     Prints version information

OPTIONS:
    -L, --libdir &lt;LIB_DIR|BASE_URL&gt;...    Add a directory or base Url to the Library Search path
    -o, --output &lt;OUTPUT_DIR&gt;             Specify the output directory for generated manifest
    -i, --stdin &lt;STDIN_FILENAME&gt;          Read STDIN from the named file
    -v, --verbosity &lt;VERBOSITY_LEVEL&gt;     Set verbosity level for output (trace, debug, info, warn, error (default))

ARGS:
    &lt;FLOW&gt;            the name of the 'flow' definition file to compile
    &lt;flow_args&gt;...    Arguments that will get passed onto the flow if it is executed

</code></pre>
<h3 id="command-line-options-to-flowr"><a class="header" href="#command-line-options-to-flowr">Command line options to <code>flowr</code></a></h3>
<p>By default <code>flowc</code> uses <code>flowr</code> to run the flow once it has compiled it. Also it defaults to passing the <code>-n/--native</code>
flag to <code>flowr</code> so that flows are executed using the native implementations of library functions.</p>
<p>In order to pass command line options on to <code>flowr</code> you separate them from the options to <code>flowc</code> after another <code>--</code> separator.</p>
<p><code>flowr</code> accepts the same <code>-v/--verbosity</code> verbosity options as <code>flowc</code>.</p>
<h3 id="getting-debug-output"><a class="header" href="#getting-debug-output">Getting debug output</a></h3>
<p>If you want to follow what the run-time is doing in more detail, you can increase the verbosity level (default level is ERROR)
using the <code>-v/--verbosity</code> option.</p>
<p>So, if you want to walk through each and every step of the flow's execution, similar to the previous <a href="docs/first_flow/step-by-step.html">step by step section</a> 
then you can do so by using <code>-v debug</code> and piping the output to <code>more</code> (as there is a lot of output!):</p>
<p><code>cargo run -p flowc -- samples/fibonacci -- -v debug| more</code></p>
<p>which should produce output similar to this:</p>
<pre><code class="language-bash">INFO    - 'flowr' version 0.8.8
INFO    - 'flowrlib' version 0.8.8
DEBUG   - Loading library 'context' from 'native'
INFO    - Library 'context' loaded.
DEBUG   - Loading library 'flowstdlib' from 'native'
INFO    - Library 'flowstdlib' loaded.
INFO    - Starting 4 executor threads
DEBUG   - Loading flow manifest from 'file:///Users/andrew/workspace/flow/flowsamples/fibonacci/manifest.json'
DEBUG   - Loading libraries used by the flow
DEBUG   - Resolving implementations
DEBUG   - Setup 'FLOW_ARGS' with values = '[&quot;my-first-flow&quot;]'
INFO    - Maximum jobs dispatched in parallel limited to 8
DEBUG   - Resetting stats and initializing all functions
DEBUG   - Init: Initializing Function #0 '' in Flow #0
DEBUG   -               Input initialized with 'Number(0)'
DEBUG   -               Input initialized with 'Number(1)'
DEBUG   - Init: Initializing Function #1 '' in Flow #0
DEBUG   - Init: Creating any initial block entries that are needed
DEBUG   - Init: Readying initial functions: inputs full and not blocked on output
DEBUG   -               Function #0 not blocked on output, so added to 'Ready' list
DEBUG   - ===========================    Starting flow execution =============================
DEBUG   - Job #0:-------Creating for Function #0 '' ---------------------------
DEBUG   - Job #0:       Inputs: [[Number(0)], [Number(1)]]
DEBUG   - Job #0:       Sent for execution
DEBUG   - Job #0:       Outputs '{&quot;i1&quot;:0,&quot;i2&quot;:1,&quot;sum&quot;:1}'
DEBUG   -               Function #0 sending '1' via output route '/sum' to Self:1
DEBUG   -               Function #0 sending '1' via output route '/sum' to Function #1:0
DEBUG   -               Function #1 not blocked on output, so added to 'Ready' list
DEBUG   -               Function #0 sending '1' via output route '/i2' to Self:0
DEBUG   -               Function #0, inputs full, but blocked on output. Added to blocked list
DEBUG   - Job #1:-------Creating for Function #1 '' ---------------------------
DEBUG   - Job #1:       Inputs: [[Number(1)]]
DEBUG   -                               Function #0 removed from 'blocked' list
DEBUG   -                               Function #0 has inputs ready, so added to 'ready' list
DEBUG   - Job #1:       Sent for execution
DEBUG   - Job #2:-------Creating for Function #0 '' ---------------------------
DEBUG   - Job #2:       Inputs: [[Number(1)], [Number(1)]]
1
DEBUG   - Job #2:       Sent for execution
DEBUG   - Job #2:       Outputs '{&quot;i1&quot;:1,&quot;i2&quot;:1,&quot;sum&quot;:2}'
DEBUG   -               Function #0 sending '2' via output route '/sum' to Self:1
DEBUG   -               Function #0 sending '2' via output route '/sum' to Function #1:0
DEBUG   -               Function #1 not blocked on output, so added to 'Ready' list
DEBUG   -               Function #0 sending '1' via output route '/i2' to Self:0
DEBUG   -               Function #0, inputs full, but blocked on output. Added to blocked list
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="defining-flows"><a class="header" href="#defining-flows">Defining Flows</a></h2>
<p>A flow can define the entities external to the program with which it interacts. These are the &quot;context functions&quot;
provided by the run-time.</p>
<p>By definition, nothing enters or leaves the top-level root flow (named &quot;root.toml&quot; by default).
At most, things flow internally between contained sub-flows and functions (collectively known as &quot;processes&quot;), 
as defined by the connections.</p>
<p>A flow contain 0 or more sub-flows which are described in separate &quot;flow&quot; files.
The entities referenced in the top-level flow definition are connected to inputs and outputs of any sub-flow by 
connections.</p>
<p>So, valid entries in a flow definition include:</p>
<ul>
<li><code>flow</code>        - a String naming this flow (obligatory)</li>
<li><code>version</code>     - a SemVer compatible version number for this flow (Optional)</li>
<li><code>authors</code>     - Array of Strings of names and emails of authors of the flow (Optional)</li>
<li><code>io</code>          - 0 or more input/outputs of this flow made available to any parent including it</li>
<li><code>value</code>       - 0 or more values contained in this flow</li>
<li><code>process</code>     - 0 or more references to sub-processes to include under the current flow. A sub-process
can be another <code>flow</code> or a <code>function</code></li>
<li><code>connection</code>  - 0 or more connections between outputs and inputs of values or sub-processes and <code>io</code> of this flow 
(hence permitting connections to/from parent flows including this one)</li>
</ul>
<h3 id="root-of-flow"><a class="header" href="#root-of-flow">Root of Flow</a></h3>
<p>All flows start with a flow called the <code>root</code>. This is the flow that defines the interactions
of the overall flow hierarchy with the environment or &quot;context&quot; around it.</p>
<p>Any flow can contain any number of nested flows via <a href="docs/describing/process_references.html">Process References</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="name"><a class="header" href="#name">Name</a></h2>
<p>A string used to identify an element.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="io"><a class="header" href="#io">IO</a></h2>
<p>IOs produce or consume data of a specific type, and are where data enters/leaves a flow/value/function.</p>
<ul>
<li><code>name</code> - the IO Reference that is used to identify it in connections to/from it</li>
<li><code>type</code> (optional) - An optional <a href="docs/describing/types.html">Data type</a> for this IO</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="process-reference"><a class="header" href="#process-reference">Process Reference</a></h2>
<p>Flows may reference a another flow or a function which is defined in a separate 
definition file. These are referred to under the generic term of <code>process</code></p>
<h3 id="process-reference-fields"><a class="header" href="#process-reference-fields">Process Reference Fields</a></h3>
<ul>
<li><code>alias</code> - an alias to use to refer to the process in this flow.
<ul>
<li>This can be different from the <code>name</code> defined by the process itself</li>
<li>This can be used to create two difference instances of a process in a flow, 
and the ability to refer to them separately and distinguish them in connections.</li>
</ul>
</li>
<li><code>source</code> - the source of where the process is defined. </li>
</ul>
<h3 id="source-formats"><a class="header" href="#source-formats">Source formats</a></h3>
<p>The following formats for specifying the <code>source</code> are available:</p>
<ul>
<li>No &quot;scheme&quot; in the URI --&gt; <code>file:</code> is assumed</li>
<li><code>file:</code> scheme --&gt; look for process on the Local File System</li>
<li><code>http:</code> or <code>https:</code> scheme --&gt; look for process on a Remote Web Server</li>
<li><code>lib:</code> --&gt; look for process in a Library</li>
</ul>
<h4 id="local-file-system"><a class="header" href="#local-file-system">Local File System</a></h4>
<p>The process definition file is in the local file system.</p>
<ul>
<li>in the flow's directories, using relative file paths 
<ul>
<li>e.g. <code>source = &quot;my_function&quot;</code></li>
<li>e.g. <code>source = &quot;my_flow&quot;</code></li>
<li>e.g. <code>source = &quot;subdir/my_other_function&quot;</code></li>
<li>e.g. <code>source = &quot;subdir/my_other_process&quot;</code></li>
</ul>
</li>
<li>in a different flow's directories, using relative file paths
<ul>
<li>e.g. <code>source = &quot;../other_flow/other_function&quot;</code></li>
<li>e.g. <code>source = &quot;../other_flow/other_flow&quot;</code></li>
</ul>
</li>
<li>elsewhere in the local file system, using absolute paths
<ul>
<li>e.g. <code>source = &quot;/root/other_directory/other_function&quot;</code></li>
<li>e.g. <code>source = &quot;/root/other_directory/other_flow&quot;</code></li>
</ul>
</li>
</ul>
<h4 id="remote-web-server"><a class="header" href="#remote-web-server">Remote Web Server</a></h4>
<p>The process definition file can be found on a remote server, just specify the 
URL of the file:</p>
<ul>
<li>e.g. <code>source = &quot;http://my_flow_server.com/folder/function&quot;</code></li>
<li>e.g. <code>source = &quot;https://my_secure_flow_server.com/folder/flow&quot;</code></li>
</ul>
<h4 id="library-processes"><a class="header" href="#library-processes">Library Processes</a></h4>
<p>The process is in a library that is available to your current installation. 
In order for flow to find the function at compile time it uses the 
environment variable <code>FLOW_LIB_PATH</code>, that is a <code>PATH</code> style variable with zero or
more directory entries or URLs separated by the <code>&quot;,&quot;</code> character</p>
<ul>
<li>e.g. <code>source = &quot;context://stdio/stdin&quot;</code>
<ul>
<li>Library name = <code>flowrlib</code></li>
<li>Function path within the library = <code>stdio/stdin</code></li>
</ul>
</li>
</ul>
<p>All the directories in the path are searched for a top-level sub-directory that 
matches the library name.</p>
<p>If the named library is found, the Function path within the library is used to try and 
find the process definition file.</p>
<p>For example, if I define <code>FLOW_LIB_PATH</code> thus:</p>
<ul>
<li><code>FLOW_LIB_PATH=/Users/me/workspace/flow</code></li>
</ul>
<p>And my flow references a process thus:</p>
<pre><code class="language-toml">[[process]]
alias = &quot;stdin&quot;
source = &quot;context://stdio/stdin&quot;
</code></pre>
<p>Then the directory <code>/Users/me/workspace/flow/flowrlib</code> is looked for.</p>
<p>If that directory and hence the library is found, then the Function path within the library
<code>stdio/stdin</code> is used to create the full path to the Function definition file 
<code>/Users/me/workspace/flow/flowrlib/stdio/stdin</code>.</p>
<p>If that file exists and can be read, the process defined there is used and 
included in the flow.</p>
<h3 id="initializing-an-io-in-a-reference"><a class="header" href="#initializing-an-io-in-a-reference">Initializing an IO in a reference</a></h3>
<p>An IO of a reference propcess may be initialized with a value, in one of two ways:</p>
<ul>
<li><code>once</code> - the value is inserted into the IO on startup only and there after it will remain empty if a value is not 
sent to it from a Process</li>
<li><code>always</code> - the value will be inserted into the IO each time it is empty, of there is not a value already
sent from a process.</li>
</ul>
<p>When a process only has one input, and it is not named, then you can refer to it by the name
<code>default</code> for the purposes of specifying an initializer</p>
<p>Eamples:</p>
<pre><code class="language-toml">[[process]]
alias = &quot;print&quot;
source = &quot;context://stdio/stdout&quot;
input.default = {once = &quot;Hello World!&quot;}
</code></pre>
<pre><code class="language-toml">[[process]]
alias = &quot;second-start&quot;
source = &quot;lib://flowstdlib/fmt/to_json&quot;
input.default = {always = &quot;2&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="function-definitions"><a class="header" href="#function-definitions">Function Definitions</a></h2>
<p>A function is defined in a definition file (e.g. <code>add</code>) that should be alongside the function's
implementation files (see later)</p>
<p>A function can consume data on 0 or more inputs (it must have all available in order to run)
and then can produce data on 0 or more outputs. </p>
<p>A function can be a pure source of data (e.g. <code>stdin</code> that interacts with the execution environment 
to get the data and then outputs it) or a pure sink of data (e.g. <code>stdout</code> that takes 
an input and passes it to the execution environment and produces no output in the flow).</p>
<h3 id="function-definition-fields"><a class="header" href="#function-definition-fields">Function Definition Fields</a></h3>
<ul>
<li><code>name</code>   - the name of the function. This is required to link the definition with the 
implementation and allow the loader/compiler to be able to find the implementation of the
function and to include it in the generated project. <code>name</code> must match exactly the name of the 
object implemented.</li>
<li><code>input</code>  - zero or more inputs (as per <a href="docs/describing/ios.html">IO</a>)</li>
<li><code>output</code> - one or more outputs (as per <a href="docs/describing/ios.html">IO</a>)</li>
</ul>
<h3 id="run-time-semantics"><a class="header" href="#run-time-semantics">Run-time semantics</a></h3>
<p>A Function won't be run by the run-time until all its inputs are available.
When it is run it may produce a data value on it's output.</p>
<p><em>TODO</em></p>
<ul>
<li>default output</li>
<li>named outputs</li>
</ul>
<p><em>TODO</em> </p>
<ul>
<li>Describe destructuring output</li>
</ul>
<h3 id="function-implementations"><a class="header" href="#function-implementations">Function Implementations</a></h3>
<p>Must be able to be invoked by flow, and implement a defined interface to be able to invoke them and get the results.
Rust or rust ffi to use functions from other languages?</p>
<p><em>TO Consider</em></p>
<ul>
<li>specifying data types at all levels, or optionally, maybe at top level to make it very easy to 
determine the input/output &quot;contact&quot; of flow without having to load all the levels all the way done.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="types"><a class="header" href="#types">Types</a></h2>
<p>By default flow supports JSON types:</p>
<ul>
<li><code>null</code></li>
<li><code>boolean</code></li>
<li><code>object</code></li>
<li><code>array</code></li>
<li><code>number</code></li>
<li><code>string</code></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="connection"><a class="header" href="#connection">Connection</a></h2>
<p>Connections connect a source of data (via an IO Reference) to a sink of data (via an IO Reference) 
of a compatible <a href="docs/describing/types.html">type</a>:</p>
<ul>
<li><code>name</code> (Optional) - an Optional name for the flow</li>
<li><code>from</code> = <a href="docs/describing/io_references.html">IO Reference</a> to the Data source that this connection comes from</li>
<li><code>to</code> = <a href="docs/describing/io_references.html">IO Reference</a> to a Data sink that this connection goes to</li>
</ul>
<p>The type of a data flow is inferred from the two IOs that it connects (after checking the types match)</p>
<h3 id="run-time-semantics-1"><a class="header" href="#run-time-semantics-1">Run-time Semantics</a></h3>
<p>An input IO can receive data from (i.e. be connected to) multiple outputs. </p>
<p>The first to arrive is the one that will fulfil the input the connection connects to and the
destination will execute with that input value.</p>
<p>An output IO can be connected to multiple inputs on other values/flows/functions via multiple 
connections.</p>
<p>When the data is produced on the output by the Data source the data is copied to each 
Data sink via each connection that exists.</p>
<p>An output can only be produced when the data can be sent to <em>all</em> connected destinations, 
avoiding any data loss or need for buffering. The sender is blocked until all destinations are
available.</p>
<p>A function maybe blocked on output by other &quot;busy&quot; inputs, thus inputs are not overwritten 
but queued up with backpressure.</p>
<p>A function or value will not be executed until all inputs are available and it can sent its 
output to all connected destinations.</p>
<p>Loops are permitted from an output to an input, and are used as a feature to achieve certain behaviours.</p>
<h3 id="type-match"><a class="header" href="#type-match">Type Match</a></h3>
<p>For a connection to be valid and used in execution of a flow, the data source must be found,
the data sink must be found and the two must be of matching DataTypes.</p>
<p>If those conditions are not met, then a connection will be dropped (with an error message output)
and the flow will attempted to be built and executed without it.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="io-references"><a class="header" href="#io-references">IO References</a></h2>
<p>This uniquely identifies an IO from a Data source (flow/value/function).</p>
<p>If any flows or functions defined in other files are referenced with an alias, then it should be
used in the IO references to inputs or outputs of that referenced flow/function.</p>
<h3 id="data-sources"><a class="header" href="#data-sources">Data sources</a></h3>
<p>Sources of data which are valid for the <em>from</em> field of a connection are:</p>
<p>Inside a flow:</p>
<ul>
<li><code>input/{input_name}</code></li>
<li><code>value/{value_name}</code></li>
</ul>
<p>Referenced from a flow:</p>
<ul>
<li><code>{flow_alias|flow_name}/{output_name}</code></li>
<li><code>{function_alias|function_name}/{output_name}</code></li>
</ul>
<h3 id="data-sinks"><a class="header" href="#data-sinks">Data sinks</a></h3>
<p>Sinks for data which are valid for the <em>to</em> field of a connection are:</p>
<p>Inside a flow:</p>
<ul>
<li><code>output/{output_name}</code></li>
<li><code>value/{value_name}</code></li>
</ul>
<p>Referenced from a flow:</p>
<ul>
<li><code>{flow_alias|flow_name}/{input_name}</code></li>
<li><code>{function_alias|function_name}/{input_name}</code></li>
</ul>
<p>TODO </p>
<p>Using named outputs to destructure a JSON value or array or object</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="complete-feature-list"><a class="header" href="#complete-feature-list">Complete Feature List</a></h2>
<p>This is a complete list of features implemented in the description of flows:</p>
<ul>
<li>Context Flow
<ul>
<li>Cannot have any outputs from this flow as there cannot be a parent level</li>
</ul>
</li>
<li>All Flows (Context and Children)
<ul>
<li>Can contain elements directly inside the context flow description</li>
<li>Child flow inclusion from description in its own flow file in current project or different project</li>
<li>Named outputs from child flow, referenced by parent flow for connections</li>
</ul>
</li>
<li>Functions
<ul>
<li>With just inputs</li>
<li>With just outputs</li>
<li>With inputs and outputs</li>
<li>Use of aliases to refer to functions with different names inside a flow</li>
</ul>
</li>
<li>Use of Library Functions</li>
<li>Providing a Custom function (in rust) with a flow</li>
<li>Destructuring of output value into multiple named outputs</li>
<li>Connections between outputs and inputs
<ul>
<li>Connections between inputs and outputs of functions, values, current flow and sub-flows</li>
<li>Multiple connections to a single inputs (first arrived wins)</li>
<li>Multiple connections from a single output (value is copied to all destinations)</li>
<li>Connections to values don't require input name as only have one input</li>
<li>Connections from values don't require output name as only have one output</li>
<li>Functions with single input can have a connection to it without naming the input</li>
<li>Functions with single output can have a connection from it without naming the output</li>
</ul>
</li>
<li>Libraries of functions can be built and described, like flowstdlib, and referenced in flows</li>
<li>Run-time functions for
<ul>
<li>Retrieving arguments from the flow's invocation</li>
<li>STDIN/STDOUT/STDERR</li>
<li>Retrieving the value of Environment Variables</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="flow-libraries"><a class="header" href="#flow-libraries">Flow Libraries</a></h2>
<p>Libraries can provide Functions and Flows and be re-used by other flows.</p>
<p>An example is the <code>flowstdlib</code> library, but others can be created and shared by developers.</p>
<p>References to flows or functions specify a source, which refers to a file on the local file system 
or located at a URL. 
A Library search path is used to find the library sources</p>
<p>The library search path is initialized from the contents of the <code>$FLOW_LIB_PATH</code> environment variable 
(if it is defined) and maybe augmented by supplying additional directories or URLs to search using one 
or more instances of the <code>-L</code> command line option.</p>
<p>TODO</p>
<p>Format and examples of how to reference library functions from flows</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flowrlib"><a class="header" href="#flowrlib"><code>flowrlib</code></a></h1>
<p>See also: <a href="http://andrewdavidmackenzie.github.io/flow/code/doc/flowrlib/index.html">Code docs</a></p>
<p>This is the rust run-time library for flow execution. This will be linked with other code to produce a flow
runner, such as the <code>flowr</code> command line runner.</p>
<p>It is responsible for reading a flow definition in a <code>Manifest</code> file, loading the required libraries 
from <code>LibraryManifest</code> files and then coordinating the execution by dispatching <code>Jobs</code> to be executed 
by <code>Function</code> <code>Implementations</code>, providing them the <code>Inputs</code> required to run and gathering the <code>Outputs</code> produced 
and passing those <code>Outputs</code> to other connected <code>Functions</code> in the network of <code>Functions</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flowr"><a class="header" href="#flowr"><code>flowr</code></a></h1>
<p>See also: <a href="http://andrewdavidmackenzie.github.io/flow/code/doc/flowr/index.html">Code docs</a></p>
<p><code>flowr</code> is a binary run-time for running flows from the CLI built using the <code>flowrlib</code> library.</p>
<p>It handles the execution of <code>Functions</code> forming a <code>Flow</code> according to the defined semantics.</p>
<h2 id="context-functions"><a class="header" href="#context-functions">Context Functions</a></h2>
<p>The <code>flowr</code> <code>context</code> module implements the context functions that this runtime
provides for flows to interact with the surrounding &quot;context&quot; it is being run in, such as IO and File System.</p>
<p>These are all impure functions, or functions with side effects, not part of the flow itself.</p>
<p>Those functions are organized into the following modules, each with multiple functions:</p>
<ul>
<li><a href="flowr/src/context/args/args.html">args</a> - used to get arguments that flow was invoked with</li>
<li><a href="flowr/src/context/file/file.html">file</a> - used to interact with the file system</li>
<li><a href="flowr/src/context/image/image.html">image</a> - used to create image files</li>
<li><a href="flowr/src/context/stdio/stdio.html">stdio</a> - used to interact with stdio</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="running-flows"><a class="header" href="#running-flows">Running Flows</a></h2>
<h3 id="run-the-fibonacci-example-flow"><a class="header" href="#run-the-fibonacci-example-flow">Run the fibonacci example flow</a></h3>
<p>From the project root you can run the fibonacci sample flow using:</p>
<p><code>cargo run  -- samples/fibonacci</code></p>
<p>You should get a fibonacci series output to the terminal, 
followed by an &quot;ERROR&quot; on a panic, that is caused by integer overflow 
when the next number gets too big (don't worry, that's expected)</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="flowc-command-line-arguments"><a class="header" href="#flowc-command-line-arguments"><code>flowc</code> Command Line Arguments</a></h2>
<p><code>flowc</code> is the flow &quot;compiler&quot;, although compiling a flow is very different to a procedural language compile.</p>
<p>What it and other components do is described in more detail later in the <a href="docs/running/../internals/overview.html">Internals</a> section.</p>
<p>This section describes command line arguments that can be supplied to <code>flowc</code> and what they are useful for.</p>
<h3 id="getting-help"><a class="header" href="#getting-help">Getting help</a></h3>
<p>Use <code>-h, --help</code> (e.g. <code>flowc -h</code> or <code>cargo run -p flowc -- -h</code>) to print out help for the usage of <code>flowc</code>. </p>
<p>This will print something like this:</p>
<pre><code class="language-shell script">flowc 0.4.0

USAGE:
    flowc [FLAGS] [OPTIONS] [ARGS]

FLAGS:
    -d, --dump       Dump the flow to standard output after loading it
    -h, --help       Prints help information
    -s, --skip       Skip code generation and running
    -V, --version    Prints version information

OPTIONS:
    -v, --verbosity &lt;VERBOSITY_LEVEL&gt; Set verbosity level for output (trace, debug, info, warn, error (default))
    -o, --output &lt;OUTPUT_DIR&gt;         Output directory for generated code

ARGS:
    &lt;FLOW&gt;            the name of the 'flow' file
    &lt;flow_args&gt;...
</code></pre>
<p>Where the first line prints the binary name and the version number.</p>
<h3 id="flags-described"><a class="header" href="#flags-described">Flags Described</a></h3>
<ul>
<li><code>-d, --dump</code> - Dumps a text representation of the the flow hierarchy to standard output after loading it</li>
<li><code>-s, --skip</code> - Skip the code generation and running of the generated flow</li>
<li><code>-V, --version</code>- Prints version information</li>
</ul>
<h3 id="options-described"><a class="header" href="#options-described">Options Described</a></h3>
<ul>
<li><code>-v, --verbosity &lt;VERBOSITY_LEVEL&gt;</code>- Set verbosity level for output (VERBOSITY_LEVEL_LEVEL can be <code>trace</code>, <code>debug</code>, <code>info</code>, <code>warn</code> or <code>error</code> (the default))</li>
<li><code>-o, --output &lt;OUTPUT_DIR&gt;</code>- Specify the output directory for generated code. By default this is in a &quot;rust&quot; 
subdirectory of the directory where the flow's context was loaded from</li>
</ul>
<h3 id="flow-directory-or-filename"><a class="header" href="#flow-directory-or-filename">Flow Directory or Filename</a></h3>
<p>After Flags and Options you can supply an optional field for where to load the context flow from.</p>
<ul>
<li>By default this is the current directory.</li>
<li>If it's a directory then it attempts to load &quot;root.toml&quot; from there</li>
<li>If it's a file then it attempts to load &quot;root.toml&quot; from that file</li>
</ul>
<p>It can also be a URL to a flow context specification somewhere on the web. Currently supports http and http.</p>
<h3 id="arguments-for-the-flow"><a class="header" href="#arguments-for-the-flow">Arguments for the flow</a></h3>
<p>If a flow directory or filename is supplied, then any files after that are assumed to be command line arguments
for the flow itself. When it starts executing it can retrieve the value of these parameters using functions
in the run-time.</p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="passing-command-line-arguments"><a class="header" href="#passing-command-line-arguments">Passing Command Line Arguments</a></h3>
<p>Arguments are passed to the flow being executed by <code>flowc</code> by placing them after the flow name in 
the execution string (either using <code>cargo run -p flowc</code> or <code>flowc</code> directly). 
e.g. <code>cargo run -p flowc -- samples/mandlebrot mandel.png 4000x3000 -1.20,0.35 -1,0.20</code></p>
<p>The <code>context</code> functions include a function called <code>args/get</code> that can be used to read the arguments, 
allowing them to then be processed in the flow like any other inputs.</p>
<p>Include the <code>args/get</code> function in your flow:</p>
<pre><code class="language-toml">[[process]]
alias = &quot;args&quot;
source = &quot;lib://flkowr/args/get&quot;
</code></pre>
<p>Then create a connection from the desired output (second arg in this example) of <code>args/get</code> to another function:</p>
<pre><code class="language-toml">[[connection]]
from = &quot;function/args/2&quot;
to = &quot;function/parse_bounds/input&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h3 id="what-file-to-select-as-the-context"><a class="header" href="#what-file-to-select-as-the-context">What file to select as the Context?</a></h3>
<p><code>flowc</code> determines the flow to run using one of these three methods:</p>
<ul>
<li>no filename or directory passed, so it looks for &quot;root.toml&quot; in the current directory</li>
<li>a filename or directory is passed:
<ul>
<li>if the parameter passed is a directory, it looks for &quot;root.toml&quot; in that directory</li>
<li>if a filename is passed, it uses that as the flow to load</li>
</ul>
</li>
</ul>
<p>Then it tries to load the flow hierarchy from the context flow found, or reports an error if 
none was found.</p>
<p>TODO: Document URL format and lack of folder option.</p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="standard-input"><a class="header" href="#standard-input">Standard Input</a></h3>
<p><code>context</code> provides functions to read from STDIN. You can pipe input to the flow by piping
it to the <code>cargo run -p flowc</code> or <code>flowc</code> command line used to execute the flow.</p>
<p>If not piped in, then the <code>stdin</code> function will attempt to read STDIN, blocking that function until input 
(or EOF) is provided. If input is read then it will be passed on by that function at its output.
The function will indicate to the run-time that it should be run again (to read more lines of STDIN)
and it will be re-added to the ready list and executed again later.</p>
<p>When EOF is detected, that function will indicate to the run-time that it does not want to be run again
and will not be added back to the ready list for re-execution.</p>
<h3 id="standard-output--standard-error"><a class="header" href="#standard-output--standard-error">Standard Output &amp; Standard Error</a></h3>
<p><code>context</code> provides functions to send output to STDOUT/STDERR. This output is printed on 
stdout or stderr of the process that executed the <code>cargo run -p flowc</code> or <code>flowc</code> command to execute the flow.</p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="exceptions-and-panics"><a class="header" href="#exceptions-and-panics">Exceptions and Panics</a></h3>
<p>Currently, there are no special provisions for handling or recovering from run-time exceptions.
The functions are implemented in rust and when they fail they will panic as usual in rust.</p>
<p>The run-time does catch the panic, report it via an ERROR log statement, with details, and then exit.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="args-contextargs"><a class="header" href="#args-contextargs">Args (//context/args)</a></h2>
<p>Functions to handle run-time arguments, command line arguments from invocation, etc</p>
<ul>
<li><a href="flowr/src/context/args/get.html">get</a> - get the arguments the flow was invoked with</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="args-contextargsget"><a class="header" href="#args-contextargsget">Args (//context/args/get)</a></h2>
<p>Get the arguments the flow was executed with</p>
<h3 id="definition"><a class="header" href="#definition">Definition</a></h3>
<pre><code class="language-toml">function = &quot;get&quot;
source = &quot;get.rs&quot;
docs = &quot;get.md&quot;
impure = true

[[output]]
name = &quot;string&quot;
type = &quot;array/string&quot;

[[output]]
name = &quot;json&quot;
type = &quot;array/object&quot;
</code></pre>
<h3 id="include-using"><a class="header" href="#include-using">Include using</a></h3>
<pre><code class="language-toml">[[process]]
alias = &quot;get&quot;
source = &quot;context://args/get&quot;
</code></pre>
<h3 id="inputs"><a class="header" href="#inputs">Inputs</a></h3>
<h3 id="output"><a class="header" href="#output">Output</a></h3>
<ul>
<li>text - Array of Strings of the command line arguments the flow was invoked with.</li>
<li>json - Array of Json parsed values of the command line arguments the flow was invoked with.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="file-contextfile"><a class="header" href="#file-contextfile">File (//context/file)</a></h2>
<p>Functions to interact with the Environment, related to file input and output.</p>
<ul>
<li><a href="flowr/src/context/file/file_write.html">write</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="write-contextfilewrite"><a class="header" href="#write-contextfilewrite">Write (//context/file/write)</a></h2>
<p>Writes <code>bytes</code> of data supplied to the file named <code>filename</code>, creating it if necessary.</p>
<h3 id="definition-1"><a class="header" href="#definition-1">Definition</a></h3>
<pre><code class="language-toml"> function = &quot;file_write&quot;
source = &quot;file_write.rs&quot;
docs = &quot;file_write.md&quot;
impure = true

[[input]]
name = &quot;filename&quot;
type = &quot;string&quot;

[[input]]
name = &quot;bytes&quot;
type = &quot;array&quot;
</code></pre>
<h3 id="include-using-1"><a class="header" href="#include-using-1">Include using</a></h3>
<pre><code class="language-toml">[[process]]
alias = &quot;write&quot;
source = &quot;context://file/write&quot;
</code></pre>
<h3 id="inputs-1"><a class="header" href="#inputs-1">Inputs</a></h3>
<ul>
<li><code>bytes</code> - the data to be written to the file</li>
<li><code>filename</code> - String with the name of the file to be written, absolute or relative to the current working
directory of the process invoking the flow.</li>
</ul>
<h4 id="outputs"><a class="header" href="#outputs">Outputs</a></h4>
<div style="break-before: page; page-break-before: always;"></div><h2 id="image--contextimage"><a class="header" href="#image--contextimage">Image  (//context/image)</a></h2>
<p>Functions to write to Images</p>
<ul>
<li><a href="flowr/src/context/image/image_buffer.html">image_buffer</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="imagebuffer-contextimageimage_buffer"><a class="header" href="#imagebuffer-contextimageimage_buffer">ImageBuffer (//context/image/image_buffer)</a></h2>
<p>Write <code>pixels</code> to an image buffer</p>
<h3 id="definition-2"><a class="header" href="#definition-2">Definition</a></h3>
<pre><code class="language-toml">function = &quot;image_buffer&quot;
source = &quot;image_buffer.rs&quot;
docs = &quot;image_buffer.md&quot;
impure = true

[[input]]
name = &quot;pixel&quot;
type = &quot;array/number&quot;

[[input]]
name = &quot;value&quot;
type = &quot;array/number&quot;

[[input]]
name = &quot;size&quot;
type = &quot;array/number&quot;

[[input]]
name = &quot;filename&quot;
type = &quot;string&quot;
</code></pre>
<h3 id="include-using-2"><a class="header" href="#include-using-2">Include using</a></h3>
<pre><code class="language-toml">[[process]]
alias = &quot;buffer&quot;
source = &quot;context://file/image_buffer&quot;
</code></pre>
<h3 id="inputs-2"><a class="header" href="#inputs-2">Inputs</a></h3>
<ul>
<li><code>pixel</code> - the (x, y) of the pixel</li>
<li><code>value</code> - the (r, g, b) triplet to write to the pixel</li>
<li><code>size</code>  - the (width, height) of the image buffer</li>
<li><code>filename</code> - the file name to persist the buffer to</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="stdio-contextstdio"><a class="header" href="#stdio-contextstdio">Stdio (//context/stdio)</a></h2>
<p>Functions to interact with the Environment, related to standard input and output (and error).</p>
<p>The values sent to these functions are read from standard input of the process that launched the flow
causing the function to block until input (or EOF) is detected. Output is printed on the STDOUT/STDERR
of the process invoking the flow.</p>
<ul>
<li><a href="flowr/src/context/stdio/readline.html">readline</a></li>
<li><a href="flowr/src/context/stdio/stderr.html">stderr</a></li>
<li><a href="flowr/src/context/stdio/stdin.html">stdin</a></li>
<li><a href="flowr/src/context/stdio/stdout.html">stdout</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="readline-contextstdioreadline"><a class="header" href="#readline-contextstdioreadline">Readline (//context/stdio/readline)</a></h2>
<p>Read a line of text from the STDIN of the process invoking the flow. The line is terminated by EOL
but leading and trailing whitespace are trimmed before being output.</p>
<p>The function will be scheduled for running again, until EOF is detected, after which it will not run
again.</p>
<h3 id="definition-3"><a class="header" href="#definition-3">Definition</a></h3>
<pre><code class="language-toml">function = &quot;readline&quot;
source = &quot;readline.rs&quot;
docs = &quot;readline.md&quot;
impure = true

[[output]]
name = &quot;string&quot;
type = &quot;string&quot;

[[output]]
name = &quot;json&quot;
type = &quot;object&quot;
</code></pre>
<h3 id="include-using-3"><a class="header" href="#include-using-3">Include using</a></h3>
<pre><code class="language-toml">[[process]]
alias = &quot;readline&quot;
source = &quot;context://stdio/readline&quot;
</code></pre>
<h3 id="inputs-3"><a class="header" href="#inputs-3">Inputs</a></h3>
<h4 id="output-1"><a class="header" href="#output-1">Output</a></h4>
<ul>
<li>text - Line of text read from STDIN - with leading and trailing whitespace trimmed.</li>
<li>json - Json value parsed from from STDIN</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="stdin-contextstdiostdin"><a class="header" href="#stdin-contextstdiostdin">Stdin (//context/stdio/stdin)</a></h2>
<p>Read text from the STDIN of the process invoking the flow until EOF is detected, after which it will not run
again. If you wish to get the value of a line (i.e. after ENTER is pressed, then use <a href="flowr/src/context/stdio/readline.html">readline</a>)</p>
<h3 id="definition-4"><a class="header" href="#definition-4">Definition</a></h3>
<pre><code class="language-toml">function = &quot;stdin&quot;
source = &quot;stdin.rs&quot;
docs = &quot;stdin.md&quot;
impure = true

[[output]]
name = &quot;string&quot;
type = &quot;string&quot;

[[output]]
name = &quot;json&quot;
type = &quot;object&quot;
</code></pre>
<h3 id="include-using-4"><a class="header" href="#include-using-4">Include using</a></h3>
<pre><code class="language-toml">[[process]]
alias = &quot;stdin&quot;
source = &quot;context://stdio/stdin&quot;
</code></pre>
<h3 id="inputs-4"><a class="header" href="#inputs-4">Inputs</a></h3>
<h3 id="output-2"><a class="header" href="#output-2">Output</a></h3>
<ul>
<li>text - Text read from STDIN - with leading and trailing whitespace (including EOF) trimmed.</li>
<li>json - Json value parsed from from STDIN</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="stdout-contextstdiostdout"><a class="header" href="#stdout-contextstdiostdout">Stdout (//context/stdio/stdout)</a></h2>
<p>Output text to the STDOUT of the process invoking the flow. If an array is passed then each element
is output on a separate line.</p>
<h3 id="definition-5"><a class="header" href="#definition-5">Definition</a></h3>
<pre><code class="language-toml">function = &quot;stdout&quot;
source = &quot;stdout.rs&quot;
docs = &quot;stdout.md&quot;
impure = true

[[input]]
type = &quot;object&quot;
</code></pre>
<h3 id="include-using-5"><a class="header" href="#include-using-5">Include using</a></h3>
<pre><code class="language-toml">[[process]]
alias = &quot;stdout&quot;
source = &quot;context://stdio/stdout&quot;
</code></pre>
<h3 id="input"><a class="header" href="#input">Input</a></h3>
<ul>
<li>(default) - the object to output a String representation of (String, boolean, Number, array)</li>
</ul>
<h3 id="output-3"><a class="header" href="#output-3">Output</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h2 id="stderr-contextstdiostderr"><a class="header" href="#stderr-contextstdiostderr">Stderr (//context/stdio/stderr)</a></h2>
<p>Output text to the STDERR of the process invoking the flow. If an array is passed then each element
is output on a separate line.</p>
<h3 id="definition-6"><a class="header" href="#definition-6">Definition</a></h3>
<pre><code class="language-toml">function = &quot;stderr&quot;
source = &quot;stderr.rs&quot;
docs = &quot;stderr.md&quot;
impure = true

[[input]]
type = &quot;object&quot;
</code></pre>
<h3 id="include-using-6"><a class="header" href="#include-using-6">Include using</a></h3>
<pre><code class="language-toml">[[process]]
alias = &quot;stderr&quot;
source = &quot;context://stdio/stderr&quot;
</code></pre>
<h3 id="input-1"><a class="header" href="#input-1">Input</a></h3>
<ul>
<li>(default) - the object to output a String representation of (string, boolean, number, array)</li>
</ul>
<h4 id="output-4"><a class="header" href="#output-4">Output</a></h4>
<div style="break-before: page; page-break-before: always;"></div><h3 id="the-flow-debugger"><a class="header" href="#the-flow-debugger">The Flow Debugger</a></h3>
<p>NOTE: To be able to use the flow debugger that is part of <code>flowr</code>, <code>flowr</code> must be compiled with
the <code>&quot;debugger&quot;</code> feature enabled. If not, the debugger code is not included in <code>flowr</code>.</p>
<h4 id="compiling-with-debug-symbols"><a class="header" href="#compiling-with-debug-symbols">Compiling with Debug Symbols</a></h4>
<p>The debugger can be used to debug any flow, but flows compiled by <code>flowc</code> using the <code>-g</code> or <code>--symbols</code>
option will have extra human readable content included in the compiled manifest (names of processes
etc) and be more convenient to debug.</p>
<h4 id="running-the-flow-with-the-debugger"><a class="header" href="#running-the-flow-with-the-debugger">Running the flow with the debugger</a></h4>
<p>To start debugging a flow, run it using <code>flowr</code> as normal, but using the <code>-d</code> or <code>--debugger</code>
options.</p>
<p>The compiled flow manifest will be loaded by <code>flowr</code> as usual, functions initialized and a command prompt
for the debugger will be shown.</p>
<p>You can use the <code>'h'</code> or <code>'help'</code> command at the prompt to to get help on debugger commands.</p>
<p>If you want to inspect the state of the flow at a particular point to debug a problem or understand 
its execution then you will probably want to either set some breakpoints initially before running the 
flow, or to step through the flow's execution one function invocation at a time.</p>
<p>Those can be done using the <code>Break</code> command to set breakpoints, the <code>List</code> command to list breakpoints set,
the <code>Run</code> command to start flow execution, the <code>Continue</code> command to continue execution after a breakpoint triggers,
and the <code>Step</code> command to step forward one function invocation.</p>
<h4 id="debugger-commands"><a class="header" href="#debugger-commands">Debugger Commands</a></h4>
<ul>
<li>
<p>Break: Set a breakpoint on a function (by id), an output or an input using spec:
** function_id
** source_id/output_route ('source_id/' for default output route)
** destination_id:input_number
** blocked_process_id-&gt;blocking_process_id</p>
</li>
<li>
<p>Continue: Continue execution until next breakpoint or end of execution</p>
</li>
<li>
<p>Delete a breakpoint: Delete the breakpoint matching {spec} or all breakpoints with '*'</p>
</li>
<li>
<p>Exit: Stop flow execution and exit debugger</p>
</li>
<li>
<p>Help: Display this help message</p>
</li>
<li>
<p>List breakpoints: List all breakpoints</p>
</li>
<li>
<p>Print: Print the overall state, or state of process number 'n'</p>
</li>
<li>
<p>Quit: Stop flow execution and exit debugger (same as Exit)</p>
</li>
<li>
<p>Run: Run the flow or if running already then reset the state to initial state</p>
</li>
<li>
<p>Step: Step over the next 'n' jobs (default = 1) then break</p>
</li>
<li>
<p>Validate: Run a series of defined checks to validate the status of flow</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flowstdlib"><a class="header" href="#flowstdlib"><code>flowstdlib</code></a></h1>
<p>See also: <a href="http://andrewdavidmackenzie.github.io/flow/code/doc/flowstdlib/index.html">Code docs</a></p>
<p><code>flowstdlib</code> is a standard library of functions and flows for <code>flow</code> programs to use.</p>
<h2 id="modules"><a class="header" href="#modules">Modules</a></h2>
<p><code>flowstdlib</code> contains the following modules:</p>
<ul>
<li><a href="flowstdlib/control/control.html"><code>control</code></a></li>
<li><a href="flowstdlib/data/data.html"><code>data</code></a></li>
<li><a href="flowstdlib/fmt/fmt.html"><code>fmt</code></a></li>
<li><a href="flowstdlib/math/math.html"><code>math</code></a></li>
</ul>
<h2 id="use-by-the-compiler"><a class="header" href="#use-by-the-compiler">Use by the Compiler</a></h2>
<p>In order for the compiler to be able to find the library's <code>flow</code> and <code>function</code> definitions, the directory containing
this library must be part of <code>FLOW_LIB_PATH</code> or specified using an instance of the <code>-L</code> command line option to <code>flowc</code>, </p>
<h2 id="building-this-library-from-source"><a class="header" href="#building-this-library-from-source">Building this library from Source</a></h2>
<p>Libraries like <code>flowstdlib</code> are built using <code>flowc</code> with the <code>-l</code> option. </p>
<p>This builds a directory tree of all required files for a portable library, including:-</p>
<ul>
<li>documentation files (.md MarkDown files, generated .dot files and generated SVG files)</li>
<li>TOML definition files for flows and functions</li>
<li>Function implementations compiled to a .wasm WASM file for each function.</li>
<li>A <code>manifest.json</code> manifest of the libraries functions and where the implementations (.wasm files) can be found. <br />
This is used by the Runtime to be able to load it.</li>
</ul>
<h2 id="native-use-by-a-runtime"><a class="header" href="#native-use-by-a-runtime">Native use by a Runtime</a></h2>
<p>It can be compiled and linked natively to a (rust) run-time. <code>flowr</code> offers the <code>-n</code> option to specify this use of it.</p>
<h2 id="wasm-use-by-a-runtime"><a class="header" href="#wasm-use-by-a-runtime">WASM use by a Runtime</a></h2>
<p>Its functions can  be loaded from WASM files by <code>flowrlib</code> at run-time using the <code>manifest.json</code> file to locate them.</p>
<h2 id="configuring-flow_lib_path-during-development"><a class="header" href="#configuring-flow_lib_path-during-development">Configuring <code>FLOW_LIB_PATH</code> during development</a></h2>
<p>If you are using it as part of the larger <code>flow</code> workspace then you just need the <code>flow</code> project root directory
in your <code>FLOW_LIB_PATH</code> as described above (or added to the lib search part using the <code>-L &lt;dir&gt;</code> option).</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="control-flowstdlibcontrol"><a class="header" href="#control-flowstdlibcontrol">Control (//flowstdlib/control)</a></h2>
<p>Functions and flows to control the flow of data in a flow based on control inputs.</p>
<h2 id="list-of-functions-and-flows"><a class="header" href="#list-of-functions-and-flows">List of Functions and Flows</a></h2>
<ul>
<li><a href="flowstdlib/control/compare_switch/compare_switch.html"><code>compare_switch</code></a></li>
<li><a href="flowstdlib/control/index/index.html"><code>index</code></a></li>
<li><a href="flowstdlib/control/index_f.html"><code>index_f</code></a></li>
<li><a href="flowstdlib/control/join/join.html"><code>join</code></a></li>
<li><a href="flowstdlib/control/route/route.html"><code>route</code></a></li>
<li><a href="flowstdlib/control/select/select.html"><code>select</code></a></li>
<li><a href="flowstdlib/control/tap/tap.html"><code>tap</code></a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="compareswitch-flowstdlibcontrolcompare_switch"><a class="header" href="#compareswitch-flowstdlibcontrolcompare_switch">CompareSwitch (//flowstdlib/control/compare_switch)</a></h2>
<h3 id="description"><a class="header" href="#description">Description</a></h3>
<p>Compares two input values and outputs the right hand and left hand values on different outputs, 
depending on the comparison result:</p>
<h4 id="equal"><a class="header" href="#equal"><strong>equal</strong></a></h4>
<p>The left/right value is output on the &quot;equal&quot; output</p>
<h4 id="greater-than"><a class="header" href="#greater-than"><strong>greater than</strong></a></h4>
<p>The left value is output on the &quot;left-gt&quot;, right value on the &quot;right-gt&quot; output</p>
<h4 id="greater-than-or-equal"><a class="header" href="#greater-than-or-equal"><strong>greater than or equal</strong></a></h4>
<p>The left value is output on the &quot;left-gte&quot;, right value on the &quot;right-gte&quot; output</p>
<h4 id="less-than"><a class="header" href="#less-than"><strong>less than</strong></a></h4>
<p>The left value is output on the &quot;left-lt&quot; output, right value is output on the &quot;right-lt&quot; output
####<strong>less than or equal</strong>
The left value is output on the &quot;left-lte&quot; output, right value is output on the &quot;right-lte&quot; output</p>
<h3 id="usage"><a class="header" href="#usage">Usage</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/control/compare_switch&quot;
</code></pre>
<h3 id="definition-7"><a class="header" href="#definition-7">Definition</a></h3>
<pre><code class="language-toml">function = &quot;compare_switch&quot;
source = &quot;compare_switch.rs&quot;
docs = &quot;compare_switch.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;left&quot; # - left hand input
type = &quot;number&quot;

[[input]]
name = &quot;right&quot; # - right hand input
type = &quot;number&quot;

[[output]]
name = &quot;equal&quot; # - outputs right hand value if the two values are equal
type = &quot;number&quot;

[[output]]
name = &quot;right-lt&quot; # - outputs right hand value if the left hand value is less than the right hand value
type = &quot;number&quot;

[[output]]
name = &quot;right-lte&quot; # - outputs right hand value if the left hand value is less than or equal to the right hand value
type = &quot;number&quot;

[[output]]
name = &quot;right-gt&quot; # - outputs right hand value if the left hand value is greater than the right hand value
type = &quot;number&quot;

[[output]]
name = &quot;right-gte&quot; # - outputs right hand value if the left hand value is greater than or equal to the right hand value
type = &quot;number&quot;

[[output]]
name = &quot;left-lt&quot; # - outputs left hand value if the left hand value is less than the right hand value
type = &quot;number&quot;

[[output]]
name = &quot;left-lte&quot; # - outputs left hand value if the left hand value is less than or equal to the right hand value
type = &quot;number&quot;

[[output]]
name = &quot;left-gt&quot; # - outputs left hand value if the left hand value is greater than the right hand value
type = &quot;number&quot;

[[output]]
name = &quot;left-gte&quot; # - outputs left hand value if the left hand value is greater than or equal to the right hand value
type = &quot;number&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="index-flowstdlibcontrolindex"><a class="header" href="#index-flowstdlibcontrolindex">Index (//flowstdlib/control/index)</a></h2>
<p>Pass thru a value based on the index of an item in the stream of values</p>
<h3 id="definition-8"><a class="header" href="#definition-8">Definition</a></h3>
<pre><code class="language-toml">function = &quot;index&quot;
source = &quot;index.rs&quot;
docs = &quot;index.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;value&quot; # - the stream of input values to select from
type = &quot;object&quot;

[[input]]
name = &quot;previous_value&quot; # - the loop-backed previous value to enable selecting &quot;last&quot;
type = &quot;object&quot;

[[input]]
name = &quot;previous_index&quot; # - the loop-backed previous index to enable counting
type = &quot;number&quot;

[[input]]
name = &quot;select_index&quot; # th index to select from, where -1 = &quot;last&quot;
type = &quot;number&quot;

[[output]]
name = &quot;index&quot; # the index of the value just processed and output on &quot;value&quot;
type = &quot;number&quot;

[[output]]
name = &quot;value&quot; # the value just processed
type = &quot;object&quot;

[[output]]
name = &quot;selected_value&quot; # the value selected by index - only output when selected
type = &quot;object&quot;
</code></pre>
<h3 id="include-using-7"><a class="header" href="#include-using-7">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/control/index&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="index_f-flowstdlibcontrolindex_f"><a class="header" href="#index_f-flowstdlibcontrolindex_f">index_f (//flowstdlib/control/index_f)</a></h2>
<p>A flow wrapper for the <a href="flowstdlib/control/index/index.html">index</a> function to simplify its use by supplying most frequently
used initializers to some inputs. </p>
<h3 id="definition-9"><a class="header" href="#definition-9">Definition</a></h3>
<pre><code class="language-toml">flow = &quot;index_f&quot;
docs = &quot;index_f.md&quot;

[metadata]
description = &quot;A wrapper flow to simplify the use of the index function for standard use cases&quot;

[[input]]
name = &quot;value&quot;
type = &quot;object&quot;

[[input]]
name = &quot;select_index&quot;
type = &quot;number&quot;

[[output]]
name = &quot;selected_value&quot;
type = &quot;object&quot;

# the index function we wrap
[[process]]
source = &quot;lib://flowstdlib/control/index&quot;
input.previous_index = { once = -1 } # so first value through will get an index of 0
input.previous_value = { once = 42 } # fake

# connect up inputs
[[connection]]
from = &quot;input/value&quot;
to = &quot;index/value&quot;

[[connection]]
from = &quot;input/select_index&quot;
to = &quot;index/select_index&quot;

# loopback connections
[[connection]]
from = &quot;index/value&quot;
to = &quot;index/previous_value&quot;

[[connection]]
from = &quot;index/index&quot;
to = &quot;index/previous_index&quot;

# connect up output
[[connection]]
from = &quot;index/selected_value&quot;
to = &quot;output/selected_value&quot;
</code></pre>
<h3 id="include-using-8"><a class="header" href="#include-using-8">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/control/index_f&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="join-flowstdlibcontroljoin"><a class="header" href="#join-flowstdlibcontroljoin">Join (//flowstdlib/control/join)</a></h2>
<p>Control the flow of a piece of data by waiting for a second value to be available</p>
<h3 id="definition-10"><a class="header" href="#definition-10">Definition</a></h3>
<pre><code class="language-toml">function = &quot;join&quot;
source = &quot;join.rs&quot;
docs = &quot;join.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;data&quot; # - the data we wish to control the flow of
type = &quot;object&quot;

[[input]]
name = &quot;control&quot; # - a second value we wait on
type = &quot;object&quot;

[[output]]
type = &quot;object&quot;
</code></pre>
<h3 id="include-using-9"><a class="header" href="#include-using-9">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/control/join&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="route-flowstdlibcontrolroute"><a class="header" href="#route-flowstdlibcontrolroute">Route (//flowstdlib/control/route)</a></h2>
<p>Route data to one or another based on a boolean control value.</p>
<h3 id="definition-11"><a class="header" href="#definition-11">Definition</a></h3>
<pre><code class="language-toml">function = &quot;route&quot;
source = &quot;route.rs&quot;
docs = &quot;route.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;data&quot; # - the data flow we wish to control the flow if
type = &quot;object&quot;

[[input]]
name = &quot;control&quot; # - a boolean value to determine which output roue `data` is passed to
type = &quot;boolean&quot;

[[output]]
name = &quot;true&quot; # `if `control` is true `data` is routed here
type = &quot;object&quot;

[[output]]
name = &quot;false&quot; # if `control` is false `data` is routed here
type = &quot;object&quot;
</code></pre>
<h3 id="include-using-10"><a class="header" href="#include-using-10">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/control/route&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="select-flowstdlibcontrolselect"><a class="header" href="#select-flowstdlibcontrolselect">Select (//flowstdlib/control/select)</a></h2>
<p>Select which data to outputbased on a boolean control value.</p>
<h3 id="definition-12"><a class="header" href="#definition-12">Definition</a></h3>
<pre><code class="language-toml">function = &quot;select&quot;
source = &quot;select.rs&quot;
docs = &quot;select.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;i1&quot;
type = &quot;object&quot;

[[input]]
name = &quot;i2&quot;
type = &quot;object&quot;

[[input]]
name = &quot;control&quot; # - a boolean value to selection of inputs passed to outputs
type = &quot;boolean&quot;

[[output]]
name = &quot;select_i1&quot; # if `control` is true `i1` is selected for this output else `i2` is selected
type = &quot;object&quot;

[[output]]
name = &quot;select_i2&quot; # if `control` is true `i2` is selected for this output else `i1` is selected
type = &quot;object&quot;
</code></pre>
<h3 id="include-using-11"><a class="header" href="#include-using-11">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/control/select&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="tap-flowstdlibcontroltap"><a class="header" href="#tap-flowstdlibcontroltap">Tap (//flowstdlib/control/tap)</a></h2>
<p>Control the flow of data (flow it through this function, or have it disappear) based on a boolean control value.</p>
<h3 id="definition-13"><a class="header" href="#definition-13">Definition</a></h3>
<pre><code class="language-toml">function = &quot;tap&quot;
source = &quot;tap.rs&quot;
docs = &quot;tap.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;data&quot; # - the data flow we wish to control the flow if
type = &quot;object&quot;

[[input]]
name = &quot;control&quot; # - a boolean value to determine in `data` is passed on or not
type = &quot;boolean&quot;

[[output]]
type = &quot;object&quot; # `data` is output if `control` is true, nothing if `control` is false
</code></pre>
<h3 id="include-using-12"><a class="header" href="#include-using-12">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/control/tap&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="control-flowstdlibcontrol-1"><a class="header" href="#control-flowstdlibcontrol-1">Control (//flowstdlib/control)</a></h2>
<p>Some generic processes that act on data.</p>
<h2 id="list-of-functions-and-flows-1"><a class="header" href="#list-of-functions-and-flows-1">List of Functions and Flows</a></h2>
<ul>
<li><a href="flowstdlib/data/accumulate/accumulate.html"><code>accumulate</code></a></li>
<li><a href="flowstdlib/data/append/append.html"><code>append</code></a></li>
<li><a href="flowstdlib/data/buffer/buffer.html"><code>buffer</code></a></li>
<li><a href="flowstdlib/data/count/count.html"><code>count</code></a></li>
<li><a href="flowstdlib/data/duplicate/duplicate.html"><code>duplicate</code></a></li>
<li><a href="flowstdlib/data/duplicate_rows/duplicate_rows.html"><code>duplicate_rows</code></a></li>
<li><a href="flowstdlib/data/enumerate/enumerate.html"><code>enumerate</code></a></li>
<li><a href="flowstdlib/data/info/info.html"><code>info</code></a></li>
<li><a href="flowstdlib/data/multiply_row/multiply_row.html"><code>multiply_row</code></a></li>
<li><a href="flowstdlib/data/ordered_split/ordered_split.html"><code>ordered_split</code></a></li>
<li><a href="flowstdlib/data/remove/remove.html"><code>remove</code></a></li>
<li><a href="flowstdlib/data/sort/sort.html"><code>sort</code></a></li>
<li><a href="flowstdlib/data/split/split.html"><code>split</code></a></li>
<li><a href="flowstdlib/data/transpose/transpose.html"><code>transpose</code></a></li>
<li><a href="flowstdlib/data/zip/zip.html"><code>zip</code></a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="accumulate-flowstdlibdataaccumulate"><a class="header" href="#accumulate-flowstdlibdataaccumulate">Accumulate (//flowstdlib/data/accumulate)</a></h2>
<p>Accumulate input values into an array upto the limit specified</p>
<h3 id="definition-14"><a class="header" href="#definition-14">Definition</a></h3>
<pre><code class="language-toml">function = &quot;accumulate&quot;
source = &quot;accumulate.rs&quot;
docs = &quot;accumulate.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;values&quot; # - The stream of input values to accumulate into an array
type = &quot;object&quot;

[[input]]
name = &quot;partial&quot; # - A partial array, to use in the accumulation, adding next input `value` to it
type = &quot;object&quot;

[[input]]
name = &quot;chunk_size&quot; # - The size of the array we want to create
type = &quot;number&quot;

[[output]]
name = &quot;chunk&quot; # - The accumulated array of inputs of size `limit` or more
type = &quot;array/object&quot;

[[output]]
name = &quot;partial&quot; # - The partially accumulated array, of size smaller than `chunk_size`
type = &quot;object&quot;

[[output]]
name = &quot;chunk_size&quot; # - The chunk-size, output for use downstream or in loop-back
type = &quot;number&quot;
</code></pre>
<h3 id="include-using-13"><a class="header" href="#include-using-13">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/accumulate&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="accumulate-flowstdlibdataappend"><a class="header" href="#accumulate-flowstdlibdataappend">Accumulate (//flowstdlib/data/append)</a></h2>
<p>Append two strings</p>
<h3 id="definition-15"><a class="header" href="#definition-15">Definition</a></h3>
<pre><code class="language-toml">function = &quot;append&quot;
source = &quot;append.rs&quot;
docs = &quot;append.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;s1&quot;
type = &quot;string&quot;

[[input]]
name = &quot;s2&quot;
type = &quot;string&quot;

[[output]]
type = &quot;string&quot; # - The Concatenated string
</code></pre>
<h3 id="include-using-14"><a class="header" href="#include-using-14">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/append&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="buffer-flowstdlibdatabuffer"><a class="header" href="#buffer-flowstdlibdatabuffer">Buffer (//flowstdlib/data/buffer)</a></h2>
<p>Takes a value on it's input and sends the same value on it's output when it can
run, effectively buffering it until the downstream processs can accept it.</p>
<h3 id="definition-16"><a class="header" href="#definition-16">Definition</a></h3>
<pre><code class="language-toml">function = &quot;buffer&quot;
source = &quot;buffer.rs&quot;
docs = &quot;buffer.md&quot;
type = &quot;rust&quot;

[[input]]
type = &quot;object&quot; # - the value to buffer

[[output]]
type = &quot;object&quot; # - The buffered value
</code></pre>
<h3 id="include-using-15"><a class="header" href="#include-using-15">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/buffer&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="count-flowstdlibdatacount"><a class="header" href="#count-flowstdlibdatacount">Count (//flowstdlib/data/count)</a></h2>
<p>Takes a value on it's input and sends the same value on it's output and adds one to the count
received on 'count' input and outputs new count on 'count' output</p>
<h3 id="definition-17"><a class="header" href="#definition-17">Definition</a></h3>
<pre><code class="language-toml">function = &quot;count&quot;
source = &quot;count.rs&quot;
docs = &quot;count.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;data&quot; # the value to count and pass on
type = &quot;object&quot;

[[input]]
name = &quot;count&quot; # - the count before this data item
type = &quot;object&quot;

[[output]]
name = &quot;data&quot; # - the value passed on
type = &quot;object&quot;

[[output]]
name = &quot;count&quot; # - the incremented count of values passed thru
type = &quot;object&quot;
</code></pre>
<h3 id="include-using-16"><a class="header" href="#include-using-16">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/count&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="duplicate-flowstdlibdataduplicate"><a class="header" href="#duplicate-flowstdlibdataduplicate">Duplicate (//flowstdlib/data/duplicate)</a></h2>
<p>Takes a value on it's input and sends the same value <code>factor</code> times in an array output</p>
<h3 id="definition-18"><a class="header" href="#definition-18">Definition</a></h3>
<pre><code class="language-toml">function = &quot;duplicate&quot;
source = &quot;duplicate.rs&quot;
docs = &quot;duplicate.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;value&quot; # - the value to duplicate
type = &quot;object&quot;

[[input]]
name = &quot;factor&quot; # - how many times to duplicate the value in the output
type = &quot;number&quot;

[[output]]
type = &quot;array/object&quot; # - the array of duplicate values
</code></pre>
<h3 id="include-using-17"><a class="header" href="#include-using-17">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/duplicate&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="duplicaterows-flowstdlibdataduplicate_rows"><a class="header" href="#duplicaterows-flowstdlibdataduplicate_rows">DuplicateRows (//flowstdlib/data/duplicate_rows)</a></h2>
<p>Duplicate the rows of a matrix</p>
<h3 id="definition-19"><a class="header" href="#definition-19">Definition</a></h3>
<pre><code class="language-toml">function = &quot;duplicate_rows&quot;
source = &quot;duplicate_rows.rs&quot;
docs = &quot;duplicate_rows.md&quot;
type = &quot;rust&quot;

[[input]]
type = &quot;array/array/number&quot; # Input matrix

[[input]]
name = &quot;factor&quot; # - duplication factor
type = &quot;number&quot;

[[output]]
type = &quot;array/array/number&quot; # - matrix with duplicated rows
</code></pre>
<h3 id="include-using-18"><a class="header" href="#include-using-18">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/duplicate_rows&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="enumerate-flowstdlibdataenumerate"><a class="header" href="#enumerate-flowstdlibdataenumerate">Enumerate (//flowstdlib/data/enumerate)</a></h2>
<p>Enumerate the elements of an array</p>
<p>With an input array such as <code>[&quot;a&quot;, &quot;b&quot;]</code> it will assign an index to each element
and produce an output array of tuples (array of two elements) such as <code>[[0, &quot;a&quot;], [1, &quot;b&quot;]]</code></p>
<h3 id="definition-20"><a class="header" href="#definition-20">Definition</a></h3>
<pre><code class="language-toml">function = &quot;enumerate&quot;
source = &quot;enumerate.rs&quot;
docs = &quot;enumerate.md&quot;
type = &quot;rust&quot;

[[input]]
type = &quot;array/number&quot;          # e.g. [&quot;a&quot;, &quot;b&quot;]

[[output]]
type = &quot;array/array/number&quot;  # e.g. [[0, &quot;a&quot;], [1, &quot;b&quot;]]
</code></pre>
<h3 id="include-using-19"><a class="header" href="#include-using-19">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/enumerate&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="info-flowstdlibdatainfo"><a class="header" href="#info-flowstdlibdatainfo">Info (//flowstdlib/data/info)</a></h2>
<p>Output info about the input value</p>
<h3 id="definition-21"><a class="header" href="#definition-21">Definition</a></h3>
<pre><code class="language-toml">function = &quot;info&quot;
source = &quot;info.rs&quot;
docs = &quot;info.md&quot;
type = &quot;rust&quot;

[[input]] # - Input value

[[output]]
name = &quot;type&quot; # - String identifying the type of the input value
type = &quot;string&quot;

[[output]]
name = &quot;rows&quot; # - Number of rows in the input value
type = &quot;number&quot;

[[output]]
name = &quot;columns&quot; # - Number of columns in the input value
type = &quot;number&quot;
</code></pre>
<h3 id="include-using-20"><a class="header" href="#include-using-20">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/info&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="multiplyrow-flowstdlibdatamultiply_row"><a class="header" href="#multiplyrow-flowstdlibdatamultiply_row">MultiplyRow (//flowstdlib/data/multiply_row)</a></h2>
<p>Multiply two matrix rows to a product</p>
<h3 id="definition-22"><a class="header" href="#definition-22">Definition</a></h3>
<pre><code class="language-toml">function = &quot;multiply_row&quot;
source = &quot;multiply_row.rs&quot;
docs = &quot;multiply_row.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;a&quot;
type = &quot;array/number&quot;

[[input]]
name = &quot;b&quot;
type = &quot;array/number&quot;

[[output]]
type = &quot;number&quot;
</code></pre>
<h3 id="include-using-21"><a class="header" href="#include-using-21">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/multiply_row&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="orderedsplit-flowstdlibdataordered_split"><a class="header" href="#orderedsplit-flowstdlibdataordered_split">OrderedSplit (//flowstdlib/data/ordered_split)</a></h2>
<p>Split a string into (possibly) its constituent parts based on a separator.</p>
<p>It guarantees to produce an array of strings, ordered the same as the input string.</p>
<h3 id="definition-23"><a class="header" href="#definition-23">Definition</a></h3>
<pre><code class="language-toml">function = &quot;ordered_split&quot;
source = &quot;ordered_split.rs&quot;
docs = &quot;ordered_split.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;string&quot; # - the String to split
type = &quot;string&quot;

[[input]]
name = &quot;separator&quot; # - the String to use as a separator
type = &quot;string&quot;

[[output]]
type = &quot;array/string&quot;
</code></pre>
<h3 id="include-using-22"><a class="header" href="#include-using-22">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/ordered_split&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="remove-flowstdlibdataremove"><a class="header" href="#remove-flowstdlibdataremove">Remove (//flowstdlib/data/remove)</a></h2>
<p>Remove a value from a vector of values</p>
<h3 id="definition-24"><a class="header" href="#definition-24">Definition</a></h3>
<pre><code class="language-toml">function = &quot;remove&quot;
source = &quot;remove.rs&quot;
docs = &quot;remove.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;value&quot; # - The value to remove from the array

[[input]]
name = &quot;array&quot; # - An array, to remove `value` from
type = &quot;array/object&quot;

[[output]]
type = &quot;array/object&quot; # - The resulting array
</code></pre>
<h3 id="include-using-23"><a class="header" href="#include-using-23">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/remove&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="sort-flowstdlibdatasort"><a class="header" href="#sort-flowstdlibdatasort">Sort (//flowstdlib/data/sort)</a></h2>
<p>Sort an array of numbers</p>
<h3 id="definition-25"><a class="header" href="#definition-25">Definition</a></h3>
<pre><code class="language-toml">function = &quot;sort&quot;
source = &quot;sort.rs&quot;
docs = &quot;sort.md&quot;
type = &quot;rust&quot;

[[input]]
type = &quot;array/number&quot;

[[output]]
type = &quot;array/number&quot;
</code></pre>
<h3 id="include-using-24"><a class="header" href="#include-using-24">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/sort&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="split-flowstdlibdatasplit"><a class="header" href="#split-flowstdlibdatasplit">Split (//flowstdlib/data/split)</a></h2>
<p>Split a string into (possibly) two parts and a possible token, based on a separator.</p>
<p>This function is implemented in a deliberate way to be able to showcase parallelization.</p>
<p>Instead of going through the string in order looking for the separator and gathering an array
of sections it takes an alternative approach.</p>
<p>It starts in the middle of the string looking for a separator character from there towards the
end. If it finds one then the string is split in two and those two sub-strings are output as
an array of strings on the <code>partial</code> output. NOTE that either or both of these two sub-strings
may have separators within them, and hence need further subdivision.</p>
<p>For that reason, the <code>partial</code> output is feedback to the <code>string</code> input, and the runtime will
serialize the array of strings to the input as separate strings.</p>
<p>If from the middle to the end no separator is found, then it tries from the middle backwards
towards the beginning. If a separator is found, the two sub-strings are output on <code>partial</code>
output as before.</p>
<p>If no separator is found in either of those cases, then the string doesn't have any and is
output on the <code>token</code> output.</p>
<p>Thus, strings with separators are subdivided until strings without separators are found, and
each of those is output as a token.</p>
<p>Due to the splitting and recursion approach, the order of the output tokens is not the order
they appear in the string.</p>
<h3 id="definition-26"><a class="header" href="#definition-26">Definition</a></h3>
<pre><code class="language-toml">function = &quot;split&quot;
source = &quot;split.rs&quot;
docs = &quot;split.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;string&quot; # - the String to split
type = &quot;string&quot;

[[input]]
name = &quot;separator&quot; # - the String to use as a separator
type = &quot;string&quot;

[[output]]
name = &quot;partial&quot; # - an array of Strings that each may or may not have `separator` strings inside
# them. This should be feed-back to the input (will be serialized into Strings by the
# runtime) for further subdivision until each one cannot be split further - in which case
# it will be output as `token`
type = &quot;array/string&quot;

[[output]]
name = &quot;token-count&quot; # - the number of tokens emitted, can be used to count tokens generated
type = &quot;number&quot;

[[output]]
name = &quot;token&quot; # - a String that cannot be sub-divided further.
type = &quot;string&quot;

[[output]]
name = &quot;delta&quot; # - this is a Number that indicates if this job reduced (-1) or increased (+1) the number
# of pending jobs to complete the split task. e.g. it consumes the input string, ot there is one
# less to process. If it outputs a token then the delta to pending work is -1 (-1 input consumed
# -0 partials for further splitting). If the input string
# is split into two partial strings that are output for further splitting, then the delta to
# pending work is +1 (+2 partials -1 input)
type = &quot;number&quot;
</code></pre>
<h3 id="include-using-25"><a class="header" href="#include-using-25">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/split&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="transpose-flowstdlibdatatranspose"><a class="header" href="#transpose-flowstdlibdatatranspose">Transpose (//flowstdlib/data/transpose)</a></h2>
<p>Transpose a matricies rows and columns</p>
<h3 id="definition-27"><a class="header" href="#definition-27">Definition</a></h3>
<pre><code class="language-toml">function = &quot;transpose&quot;
source = &quot;transpose.rs&quot;
docs = &quot;transpose.md&quot;
type = &quot;rust&quot;

[[input]]
type = &quot;array/array/number&quot;

[[output]]
type = &quot;array/array/number&quot;
</code></pre>
<h3 id="include-using-26"><a class="header" href="#include-using-26">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/transpose&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="zip-flowstdlibdatazip"><a class="header" href="#zip-flowstdlibdatazip">Zip (//flowstdlib/data/zip)</a></h2>
<p>Takes two arrays of values and produce an array of tuples of pairs of values from each input array.</p>
<h3 id="definition-28"><a class="header" href="#definition-28">Definition</a></h3>
<pre><code class="language-toml">function = &quot;zip&quot;
source = &quot;zip.rs&quot;
docs = &quot;zip.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;left&quot; # - the 'left' array
type = &quot;array/object&quot;

[[input]]
name = &quot;right&quot; # - the 'right' array
type = &quot;array/object&quot;

[[output]]
name = &quot;tuples&quot; # - tuples - the array of tuples of (left, right)
type = &quot;array/object&quot;
</code></pre>
<h3 id="include-using-27"><a class="header" href="#include-using-27">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/data/zip&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="fmt-flowstdlibfmt"><a class="header" href="#fmt-flowstdlibfmt">Fmt (//flowstdlib/fmt)</a></h2>
<p>Functions for the formatting of values and conversion from one type to another.</p>
<h2 id="list-of-functions-and-flows-2"><a class="header" href="#list-of-functions-and-flows-2">List of Functions and Flows</a></h2>
<ul>
<li><a href="flowstdlib/fmt/reverse/reverse.html"><code>reverse</code></a></li>
<li><a href="flowstdlib/fmt/to_json/to_json.html"><code>to_json</code></a></li>
<li><a href="flowstdlib/fmt/to_string/to_string.html"><code>to_string</code></a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="reverse-flowstdlibfmtreverse"><a class="header" href="#reverse-flowstdlibfmtreverse">Reverse (//flowstdlib/fmt/reverse)</a></h2>
<p>Reverse a String</p>
<h3 id="definition-29"><a class="header" href="#definition-29">Definition</a></h3>
<pre><code class="language-toml">function = &quot;reverse&quot;
source = &quot;reverse.rs&quot;
docs = &quot;reverse.md&quot;
type = &quot;rust&quot;

[[input]]
type = &quot;string&quot; # The String to reverse

[[output]]
name = &quot;reversed&quot; # - The input string reversed
type = &quot;string&quot;

[[output]]
name = &quot;original&quot; # - The original input string
type = &quot;string&quot;
</code></pre>
<h3 id="include-using-28"><a class="header" href="#include-using-28">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/fmt/reverse&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="tojson-flowstdlibfmtto_json"><a class="header" href="#tojson-flowstdlibfmtto_json">ToJson (//flowstdlib/fmt/to_json)</a></h2>
<p>Convert a String to Json</p>
<h3 id="definition-30"><a class="header" href="#definition-30">Definition</a></h3>
<pre><code class="language-toml">function = &quot;to_json&quot;
source = &quot;to_json.rs&quot;
docs = &quot;to_json.md&quot;
type = &quot;rust&quot;

[[input]]
type = &quot;string&quot; # The String to convert

[[output]]
type = &quot;object&quot; # The Json equivalent of String input
</code></pre>
<h3 id="include-using-29"><a class="header" href="#include-using-29">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/fmt/to_json&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="tostring-flowstdlibfmtto_string"><a class="header" href="#tostring-flowstdlibfmtto_string">ToString (//flowstdlib/fmt/to_string)</a></h2>
<p>Convert an input type to a String</p>
<p>Current types supported are:</p>
<ul>
<li>null - A null will be printed as &quot;null&quot;</li>
<li>boolean - boolean JSON value</li>
<li>number - A JSON Number</li>
<li>string - a bit redundant, but it works</li>
<li>array - An JSON array of values that can be converted, they are converted one by one</li>
<li>object - a Map of names/objects that will also be printed out</li>
</ul>
<h3 id="definition-31"><a class="header" href="#definition-31">Definition</a></h3>
<pre><code class="language-toml">function = &quot;to_string&quot;
source = &quot;to_string.rs&quot;
docs = &quot;to_string.md&quot;
type = &quot;rust&quot;

[[input]]
type = &quot;object&quot;

[[output]]
type = &quot;string&quot; # The String equivalent of the input value
</code></pre>
<h3 id="include-using-30"><a class="header" href="#include-using-30">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/fmt/to_string&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="math-flowstdlibmath"><a class="header" href="#math-flowstdlibmath">Math (//flowstdlib/math)</a></h2>
<p>Math Functions and flows</p>
<h2 id="list-of-functions-and-flows-3"><a class="header" href="#list-of-functions-and-flows-3">List of Functions and Flows</a></h2>
<ul>
<li><a href="flowstdlib/math/add/add.html"><code>add</code></a></li>
<li><a href="flowstdlib/math/compare/compare.html"><code>compare</code></a></li>
<li><a href="flowstdlib/math/divide/divide.html"><code>divide</code></a></li>
<li><a href="flowstdlib/math/multiply/multiply.html"><code>multiply</code></a></li>
<li><a href="flowstdlib/math/range.html"><code>range</code></a></li>
<li><a href="flowstdlib/math/range_split/range_split.html"><code>range_split</code></a></li>
<li><a href="flowstdlib/math/sequence.html"><code>sequence</code></a></li>
<li><a href="flowstdlib/math/sqrt/sqrt.html"><code>sqrt</code></a></li>
<li><a href="flowstdlib/math/subtract/subtract.html"><code>subtract</code></a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="add-flowstdlibmathadd"><a class="header" href="#add-flowstdlibmathadd">Add (//flowstdlib/math/add)</a></h2>
<p>Add two inputs to produce a new output</p>
<h3 id="definition-32"><a class="header" href="#definition-32">Definition</a></h3>
<pre><code class="language-toml">function = &quot;add&quot;
source = &quot;add.rs&quot;
docs = &quot;add.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;i1&quot; # - first input of type `Number`
type = &quot;number&quot;

[[input]]
name = &quot;i2&quot; # - second input of type `Number`
type = &quot;number&quot;

[[output]]
type = &quot;number&quot;
</code></pre>
<h3 id="include-using-31"><a class="header" href="#include-using-31">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/math/add&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="compare-flowstdlibmathcompare"><a class="header" href="#compare-flowstdlibmathcompare">Compare (//flowstdlib/math/compare)</a></h2>
<p>Compare two input values and output different boolean values depending on if the comparison
is equal, greater than, greater than or equal, less than or less than or equal.</p>
<h3 id="definition-33"><a class="header" href="#definition-33">Definition</a></h3>
<pre><code class="language-toml">function = &quot;compare&quot;
source = &quot;compare.rs&quot;
docs = &quot;compare.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;left&quot; # - left hand input
type = &quot;number&quot;

[[input]]
name = &quot;right&quot; # - right hand input
type = &quot;number&quot;

[[output]]
name = &quot;equal&quot; # - `equal` - outputs true if the two values are equal
type = &quot;boolean&quot;

[[output]]
name = &quot;lt&quot; # - `lt` - outputs true if the left hand value is less than the right hand value
type = &quot;boolean&quot;

[[output]]
name = &quot;lte&quot; # - `lte` - outputs true if the left hand value is less than or equal to the right hand value
type = &quot;boolean&quot;

[[output]]
name = &quot;gt&quot; # - `gt` - outputs true if the left hand value is greater than the right hand value
type = &quot;boolean&quot;

[[output]]
name = &quot;gte&quot; # - `gte` - outputs true if the left hand value is greater than or equal to the right hand value
type = &quot;boolean&quot;
</code></pre>
<h3 id="include-using-32"><a class="header" href="#include-using-32">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/math/compare&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="divide-flowstdlibmathdivide"><a class="header" href="#divide-flowstdlibmathdivide">Divide (//flowstdlib/math/divide)</a></h2>
<p>Divide one input by another, producing outputs for the dividend, divisor, result and the remainder </p>
<h3 id="definition-34"><a class="header" href="#definition-34">Definition</a></h3>
<pre><code class="language-toml">function = &quot;divide&quot;
source = &quot;divide.rs&quot;
docs = &quot;divide.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;dividend&quot; # - the number to be divided, of type `Number`
type = &quot;number&quot;

[[input]]
name = &quot;divisor&quot; # - the number to divide by, of type `Number`
type = &quot;number&quot;

[[output]]
name = &quot;dividend&quot; # - re output the `dividend` input, of type `Number`
type = &quot;number&quot;

[[output]]
name = &quot;divisor&quot; # - re output the `divisor` input, of type `Number`
type = &quot;number&quot;

[[output]]
name = &quot;result&quot; # - the result of the division, of type `Number`
type = &quot;number&quot;

[[output]]
name = &quot;remainder&quot; # - the remainder of the division, of type `Number`
type = &quot;number&quot;
</code></pre>
<h3 id="include-using-33"><a class="header" href="#include-using-33">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/math/divide&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="multiply-flowstdlibmathmultiply"><a class="header" href="#multiply-flowstdlibmathmultiply">Multiply (//flowstdlib/math/multiply)</a></h2>
<p>Multiply one input by another</p>
<h3 id="definition-35"><a class="header" href="#definition-35">Definition</a></h3>
<pre><code class="language-toml">function = &quot;multiply&quot;
source = &quot;multiply.rs&quot;
docs = &quot;multiply.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;i1&quot; # - one number, of type `Number`
type = &quot;number&quot;

[[input]]
name = &quot;i2&quot; # - the other number, of type `Number`
type = &quot;number&quot;

[[output]]
type = &quot;number&quot; # - the multiplication of i1 and i2, of type `Number`
</code></pre>
<h3 id="include-using-34"><a class="header" href="#include-using-34">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/math/multiply&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="range-flowstdlibmathrange"><a class="header" href="#range-flowstdlibmathrange">Range (//flowstdlib/math/range)</a></h2>
<p>Generate numbers within a rnage</p>
<h3 id="definition-36"><a class="header" href="#definition-36">Definition</a></h3>
<pre><code class="language-toml">flow = &quot;range&quot;
docs = &quot;range.md&quot;

# The range to generate: [min, max] both are inclusive
[[input]]
name = &quot;range&quot;
type = &quot;array/number&quot;

# The series of numbers in the range generated
[[output]]
name = &quot;number&quot;
type = &quot;number&quot;

[[process]]
alias = &quot;range_split&quot;
source = &quot;lib://flowstdlib/math/range_split&quot;

[[connection]]
from = &quot;input/range&quot;
to = &quot;range_split/range&quot;

# Send the numbers (ranges that cannot be split further) to the output
[[connection]]
from = &quot;range_split/same&quot;
to = &quot;output/number&quot;

# Feedback the two sub-ranges for further splitting
[[connection]]
from = &quot;range_split/bottom&quot;
to = &quot;range_split/range&quot;

[[connection]]
from = &quot;range_split/top&quot;
to = &quot;range_split/range&quot;
</code></pre>
<h3 id="include-using-35"><a class="header" href="#include-using-35">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/math/range&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="range-flowstdlibmathrange_split"><a class="header" href="#range-flowstdlibmathrange_split">Range (//flowstdlib/math/range_split)</a></h2>
<p>Split a range of numbers into two sub-ranges, or output the number if they are the same</p>
<h3 id="definition-37"><a class="header" href="#definition-37">Definition</a></h3>
<pre><code class="language-toml">function = &quot;range_split&quot;
source = &quot;range_split.rs&quot;
docs = &quot;range_split.md&quot;
type = &quot;rust&quot;

# The range_split definition: an array of [smallest number in the range_split, The largest number in the range_split]
[[input]]
name = &quot;range&quot;
type = &quot;array/number&quot;

# This will be a new range (array of two numbers) in the bottom half of the input range_split
[[output]]
name = &quot;bottom&quot;
type = &quot;array/number&quot;

# This will be a new range (array of two numbers) in the top half of the input range_split
[[output]]
name = &quot;top&quot;
type = &quot;array/number&quot;

# Numbers in the range will be output here
[[output]]
name = &quot;same&quot;
type = &quot;number&quot;
</code></pre>
<h3 id="include-using-36"><a class="header" href="#include-using-36">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/math/range&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="sequence-flowstdlibmathsequence"><a class="header" href="#sequence-flowstdlibmathsequence">Sequence (//flowstdlib/math/sequence)</a></h2>
<p>Generate a sequence of numbers</p>
<h3 id="definition-38"><a class="header" href="#definition-38">Definition</a></h3>
<pre><code class="language-toml">flow = &quot;sequence&quot;
docs = &quot;sequence.md&quot;

# The number the sequence should start at
[[input]]
name = &quot;start&quot;
type = &quot;number&quot;

# 'end' is the maximum or limit of the sequence - the last we will generate
[[input]]
name = &quot;end&quot;
type = &quot;number&quot;

# 'step' is the amount to add each time
[[input]]
name = &quot;step&quot;
type = &quot;number&quot;

# The sequence of numbers we will generate
[[output]]
name = &quot;sequence&quot;
type = &quot;number&quot;

# the last value is output when the sequence ends (may not be == limit if step is not 1)
[[output]]
name = &quot;last&quot;
type = &quot;number&quot;

# For the first time around, pass the start number of the sequence into the &quot;compare&quot; process
[[connection]]
from = &quot;input/start&quot;
to = &quot;compare/right&quot;

# Put the limit of the sequence from the &quot;end&quot; input into the limit store
[[connection]]
from = &quot;input/end&quot;
to = &quot;compare/left&quot;

# compare will pass all numbers that are less than the limit
[[process]]
alias = &quot;compare&quot;
source = &quot;lib://flowstdlib/control/compare_switch&quot;

# An add process to add one to the last output of the sequence each time
[[process]]
alias = &quot;add&quot;
source = &quot;lib://flowstdlib/math/add&quot;

[[connection]]
from = &quot;input/step&quot;
to = &quot;add/i2&quot;

# loop back the 'step' value to use in each iteration
[[connection]]
from = &quot;add/i2&quot;
to = &quot;add/i2&quot;

# connect the /right-lte output of compare_switch to the output of this process - the sequence of numbers being generated
[[connection]]
from = &quot;compare/right-lte&quot;
to = &quot;output/sequence&quot;

# while the sequence is running - feed the left value (limit) back around to compare against next time
[[connection]]
from = &quot;compare/left-gt&quot;
to = &quot;compare/left&quot;

# Take the last generated number of the sequence and pass it to 'add' to add one to it for the next number
# in the sequence (if less than the limit)
[[connection]]
from = &quot;compare/right-lt&quot;
to = &quot;add/i1&quot;

# After the first iteration, each time take the sum from the adder (i.e. possibly the next number in the sequence)
# and pass it into the compare_switch function to pass it through∫ if it's less than the limit
[[connection]]
from = &quot;add&quot;
to = &quot;compare/right&quot;

# When the compare flow indicates that the number was blocked due to being too large (equal to the limit) then
# we want that to indicate that the sequence is done
[[connection]]
from = &quot;compare/right-gte&quot;
to = &quot;output/last&quot;
</code></pre>
<h3 id="include-using-37"><a class="header" href="#include-using-37">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/math/sequence&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="sqrt-flowstdlibmathsqrt"><a class="header" href="#sqrt-flowstdlibmathsqrt">Sqrt (//flowstdlib/math/sqrt)</a></h2>
<p>Calculate the square root of a number</p>
<h3 id="definition-39"><a class="header" href="#definition-39">Definition</a></h3>
<pre><code class="language-toml">function = &quot;sqrt&quot;
source = &quot;sqrt.rs&quot;
docs = &quot;sqrt.md&quot;
type = &quot;rust&quot;

[[input]]
type = &quot;number&quot;

[[output]]
type = &quot;number&quot; # Square Root of type `Number`
</code></pre>
<h3 id="include-using-38"><a class="header" href="#include-using-38">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/math/sqrt&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="subtract-flowstdlibmathsubtract"><a class="header" href="#subtract-flowstdlibmathsubtract">Subtract (//flowstdlib/math/subtract)</a></h2>
<p>Subtract one input from another to produce a new output</p>
<h3 id="definition-40"><a class="header" href="#definition-40">Definition</a></h3>
<pre><code class="language-toml">function = &quot;subtract&quot;
source = &quot;subtract.rs&quot;
docs = &quot;subtract.md&quot;
type = &quot;rust&quot;

[[input]]
name = &quot;i1&quot; # - first input of type `Number`
type = &quot;number&quot;

[[input]]
name = &quot;i2&quot; # - second input of type `Number`
type = &quot;number&quot;

[[output]]
type = &quot;number&quot; # - `i1` minus `i2` of type `Number`
</code></pre>
<h3 id="include-using-39"><a class="header" href="#include-using-39">Include using</a></h3>
<pre><code class="language-toml">[[process]]
source = &quot;lib://flowstdlib/math/subtract&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sample-flows"><a class="header" href="#sample-flows">Sample flows</a></h1>
<p>This crate and folder contains a number of sample 'flows' that have been developed during the development
of the compiler and the run-time to drive the project development and demonstrate it working. </p>
<p>They also serve as a type of regression test to make sure we don't break any of the 
semantics that the samples rely on.</p>
<p>They range from the extremely simple &quot;hello-world&quot; example to more complex ones like generation of
a fibonacci series or a mandlebrot set image.</p>
<h2 id="structure-of-each-sample"><a class="header" href="#structure-of-each-sample">Structure of each sample</a></h2>
<p>Each sample directory contains:</p>
<ul>
<li>A <code>DESCRIPTION.md</code> file that:
<ul>
<li>describes what the <code>Flow</code> does</li>
<li>lists the features of <code>flow</code> that this sample uses and demonstrates</li>
</ul>
</li>
<li>A <code>root.toml</code> file that is the root file of the flow description</li>
<li>Files used in the automated testing of each sample:
<ul>
<li><code>test_arguments.txt</code> the arguments to be passed to the flow when running it</li>
<li><code>test_input.txt</code> the input supplied to the flow when running it</li>
<li><code>expected_output.txt</code> the output that the flow is expected to produce when invoked with 
<code>text_arguments.txt</code> and input <code>test_input.txt</code></li>
</ul>
</li>
</ul>
<h2 id="compiling-the-samples"><a class="header" href="#compiling-the-samples">Compiling the Samples</a></h2>
<p>The samples set has now been converted to a rust crate with a custom build script.</p>
<p>There is no dependency declared in Cargo.toml on the other crates (as you cannot currently declare a
dependency on a binary, just a lib), but in order to build, test and run this crate/folder you will need <code>flowc</code>
and <code>flowr</code> installed and on <code>$PATH</code> in order for build scripts to find them.</p>
<p>Using <code>cargo build -p flowsamples</code> causes the build script to run, and it compiles in-place the samples
using the <code>flowc</code> compiler.</p>
<h2 id="running-the-samples"><a class="header" href="#running-the-samples">Running the Samples</a></h2>
<p>Using <code>cargo run -p flowsamples</code> causes the sample runner in main.rs to run. It looks for sub-folders in
the samples folder and then executes the sample within. </p>
<p>When running them, it uses:</p>
<ul>
<li>test.arguments - arguments passed to the flow on the command line when executing it</li>
<li>test.input - test input to send to the sample flow using STDIN</li>
</ul>
<p>The output is sent to standard output.</p>
<p>To run a specific sample only use <code>cargo run -p flowsamples {sample-name}</code></p>
<h2 id="testing-the-samples"><a class="header" href="#testing-the-samples">Testing the Samples</a></h2>
<p>You can test all samples by using <code>cargo test -p flowsamples</code>,
it will run each one in turn with the pre-defined arguments and standard input.</p>
<p>It also gathers the standard output, standard error and files generated and checks for correctness 
by comparing them to previously generated content distributed with the package.</p>
<ul>
<li>If there is any standard error found in the file test.err then the test will fail.</li>
<li>If there is no standard error then it compares standard output captured in test.output to expected.output
and fails if there is a difference.</li>
<li>If an expected.file exists then it compares it to file output in test.file and fails if there is any 
difference with the expected file.</li>
</ul>
<pre><code>cargo test -p flowsamples 
    Finished test [unoptimized + debuginfo] target(s) in 0.11s
     Running target/debug/deps/samples-9e024e2c420db146

running 16 tests
test test::test_all_samples ... ignored
test test::test_args ... ok
test test::test_arrays ... ok
test test::test_factorial ... ok
test test::test_fibonacci ... ok
test test::test_hello_world ... ok
test test::test_mandlebrot ... ok
test test::test_matrix_mult ... ok
test test::test_pipeline ... ok
test test::test_prime ... ok
test test::test_primitives ... ok
test test::test_sequence ... ok
test test::test_sequence_of_sequences ... ok
test test::test_reverse_echo ... ok
test test::test_router ... ok
test test::test_tokenizer ... ok

test result: ok. 15 passed; 0 failed; 1 ignored; 0 measured; 0 filtered out
</code></pre>
<p>NOTE: Until multiple instances of the client/server pair for running flows can be run at once, we 
need to restrict the test framework to only run one test at a time, otherwise by default it will run
multiple tests at once, and some will fail.</p>
<p>NOTE: At the moment, to make the progress more visible, each sample has a test manually added to it
in <code>samples/main.rs</code>, so for a new sample a test needs to be added by the author.</p>
<p>To test just one sample use <code>cargo test -p flowsamples {test-name}</code></p>
<pre><code>cargo test -p flowsamples test_factorial
    Finished test [unoptimized + debuginfo] target(s) in 0.12s
     Running target/debug/deps/samples-9e024e2c420db146

running 1 test
test test::test_factorial ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 15 filtered out
</code></pre>
<h2 id="default-workspace-member-crate"><a class="header" href="#default-workspace-member-crate">Default workspace member crate</a></h2>
<p>The <code>samples</code> crate is one of the <code>default-members</code> of the <code>flow</code> workspace project, so it is used if no 
particular package is supplied, thus the samples can also be built and run using:</p>
<ul>
<li><code>cargo build</code> : compile the samples using <code>flowc</code></li>
<li><code>cargo run</code>   : run the samples using <code>flowr</code></li>
<li><code>cargo test</code>  : run the samples using <code>flowr</code> and check the generated output is correct</li>
</ul>
<p>As other <code>default-members</code> are added to the workspace over time, those commands may do other things, so
just be aware that if you only want to run the samples the <code>-p samples</code> option above will be safer.</p>
<h2 id="flowsamples-executable"><a class="header" href="#flowsamples-executable"><code>flowsamples</code> executable</a></h2>
<p>There is also an executable (<code>bin</code> or binary) installed with the library called <code>flowsamples</code> that if run
without any arguments will run all the samples. You can supply it the name of a sample (the name of the folder
under <code>samples</code> where the sample is) to run just that one sample.</p>
<h2 id="developing-a-new-sample"><a class="header" href="#developing-a-new-sample">Developing a new sample</a></h2>
<p>To develop a new sample, just create a new folder under 'samples' with your sample name. </p>
<p>Add the root.toml and any other included flows and describe them.</p>
<p>Add a DESCRIPTION.md file that describes what the sample does and what features of flow it uses.</p>
<p>Add an entry in the guide's &quot;samples&quot; section that will include the DESCRIPTION.md file above.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="args"><a class="header" href="#args">args</a></h1>
<h1 id="description-1"><a class="header" href="#description-1">Description</a></h1>
<p>A flow that shows how arguments can be passed into a flow when executed and are available to functions at run-time.</p>
<h1 id="context-diagram"><a class="header" href="#context-diagram">Context Diagram</a></h1>
<p><a href="flowsamples/args/root.dot.svg" target="_blank"><img src="flowsamples/args/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used"><a class="header" href="#features-used">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li><code>context</code> Functions used (`stdio/stdout``)</li>
<li>Reduced syntax so that <code>alias</code> of referenced processes default to their names (<code>get</code> and <code>stdout</code>)</li>
<li>Selecting a specific indexed entry of an <code>array</code> output</li>
<li>Library Flows used (<code>args/get</code> from <code>flowstdlib</code>)</li>
<li>Connections between functions</li>
</ul>
<h1 id="functions-diagram"><a class="header" href="#functions-diagram">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/args/functions.dot.svg" target="_blank"><img src="flowsamples/args/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="arrays"><a class="header" href="#arrays">arrays</a></h1>
<h1 id="description-2"><a class="header" href="#description-2">Description</a></h1>
<p>Sample to show the capabilities of:</p>
<ul>
<li>
<p>gathering a stream of outputs of type Object to an input of type Object, of a specified size. 
This is done by the P2 'composer' (<code>ComposeArray</code>) function.</p>
</li>
<li>
<p>Decomposing an output of type array of objects to a stream of objects. This is done by the runtime when it sees
a connection from an array of Type to Type.</p>
</li>
<li>
<p>P1 - sequence - generates a stream of outputs of type number</p>
</li>
<li>
<p>P2 - composer - input of type Number of width 4, output of type array of number</p>
</li>
<li>
<p>P3 - adder    - input of type Number and output of type Number, adding 1 in the process</p>
</li>
<li>
<p>P4 - print    - print the output (the original sequence with '1' added to each number)</p>
</li>
</ul>
<p>This sample (with default settings on a multi-core machine) shows parallelism of the add function, dispatching
multiple jobs for it in parallel as the array of number output from the previous process is decomposed, creating
a job for each Number. You can see this by using the <code>-j</code> option of the runtime to limit the number of outstanding
jobs and the <code>-m</code> options to dump metrics after execution. The &quot;Max Number of Parallel Jobs&quot; should be similar or
greater than 4, which is the size of the array of numbers formed.</p>
<h1 id="context-diagram-1"><a class="header" href="#context-diagram-1">Context Diagram</a></h1>
<p><a href="flowsamples/arrays/root.dot.svg" target="_blank"><img src="flowsamples/arrays/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used-1"><a class="header" href="#features-used-1">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Setting initial value of a Function's inputs</li>
<li>Multiple connections into and out of functions and values</li>
<li>Library Functions</li>
<li>Implicit conversion between arrays of objects and objects done by run-time</li>
<li>Explicit conversion between a stream of objects and an array using the <code>compose_array</code> library function</li>
</ul>
<h1 id="functions-diagram-1"><a class="header" href="#functions-diagram-1">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/arrays/functions.dot.svg" target="_blank"><img src="flowsamples/arrays/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="factorial"><a class="header" href="#factorial">factorial</a></h1>
<h1 id="description-3"><a class="header" href="#description-3">Description</a></h1>
<p>A flow that calculates the factorial of a number and prints it out on <code>stdout</code>.</p>
<h1 id="context-diagram-2"><a class="header" href="#context-diagram-2">Context Diagram</a></h1>
<p><a href="flowsamples/factorial/root.dot.svg" target="_blank"><img src="flowsamples/factorial/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used-2"><a class="header" href="#features-used-2">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Connections between functions</li>
<li>Loop-back connections to accumulate a multiplication result</li>
<li>Initializing function inputs with values, once and constantly</li>
<li>Multiple connections into and out of functions</li>
<li>Library Functions <code>to_json</code>, <code>multiply</code>, <code>subtract</code> from <code>flowstdlib</code></li>
<li>Library Functions <code>tap</code>, <code>compare</code> from <code>flowstdlib</code></li>
<li>Use of aliases to refer to functions with different names inside a flow</li>
</ul>
<h1 id="functions-diagram-2"><a class="header" href="#functions-diagram-2">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/factorial/functions.dot.svg" target="_blank"><img src="flowsamples/factorial/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fibonacci"><a class="header" href="#fibonacci">fibonacci</a></h1>
<h1 id="description-4"><a class="header" href="#description-4">Description</a></h1>
<p>A flow that generates a Fibonacci series of numbers and prints it out on <code>stdout</code>.</p>
<h1 id="context-diagram-3"><a class="header" href="#context-diagram-3">Context Diagram</a></h1>
<p><a href="flowsamples/fibonacci/root.dot.svg" target="_blank"><img src="flowsamples/fibonacci/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used-3"><a class="header" href="#features-used-3">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Child flow described separately, with named outputs to parent flow</li>
<li>Connections between Input/Outputs of parent/child flows</li>
<li>Setting initial value of a Value at startup</li>
<li>Multiple connections into and out of functions and values</li>
<li><code>context</code> Functions used (<code>stdout</code>)</li>
<li>Library Functions used (<code>buffer</code> and <code>add</code> from <code>flowstdlib</code>)</li>
<li>Use of aliases to refer to functions with different names inside a flow</li>
<li>Connections between flows, functions and values</li>
</ul>
<h1 id="functions-diagram-3"><a class="header" href="#functions-diagram-3">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/fibonacci/functions.dot.svg" target="_blank"><img src="flowsamples/fibonacci/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hello-world"><a class="header" href="#hello-world">hello-world</a></h1>
<h1 id="description-5"><a class="header" href="#description-5">Description</a></h1>
<p>A simple flow that prints &quot;Hello World!&quot; on <code>stdout</code></p>
<h1 id="context-diagram-4"><a class="header" href="#context-diagram-4">Context Diagram</a></h1>
<p><a href="flowsamples/hello-world/root.dot.svg" target="_blank"><img src="flowsamples/hello-world/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used-4"><a class="header" href="#features-used-4">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Library Functions used (<code>stdout</code> from <code>flowstdlib</code>)</li>
</ul>
<h1 id="functions-diagram-4"><a class="header" href="#functions-diagram-4">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/hello-world/functions.dot.svg" target="_blank"><img src="flowsamples/hello-world/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mandlebrot"><a class="header" href="#mandlebrot">mandlebrot</a></h1>
<p>Render a mandlebrot set, with the size and imaginary space configured via input parameters.</p>
<p>The pre-configured test renders a very small mandlebrot set (25x25 pixels) in order to keep the test time short.</p>
<p><a href="flowsamples/mandlebrot/expected.file" target="_blank"><img src="flowsamples/mandlebrot/expected.file"></a></p>
<h1 id="description-6"><a class="header" href="#description-6">Description</a></h1>
<p>Renders a mandelbrot into a PNG file.</p>
<p>Notably, this project in the <code>project</code> folder is a full standalone rust project
and the functions are made available as functions to the Flow project that is described 
in the toml files alongside - showing how native code can live alongside and be used by 
the flow.</p>
<h1 id="context-diagram-5"><a class="header" href="#context-diagram-5">Context Diagram</a></h1>
<p><a href="flowsamples/mandlebrot/root.dot.svg" target="_blank"><img src="flowsamples/mandlebrot/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used-5"><a class="header" href="#features-used-5">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Child flow described separately, with named outputs to parent flow</li>
<li>Connections between Input/Outputs of parent/child flows</li>
<li>Setting initial value of a Value at startup</li>
<li>Multiple connections into and out of functions and values</li>
<li>Library Functions used (<code>toString</code> and <code>add</code> from <code>flowstdlib</code>) to convert Number to String and to add numbers</li>
<li>Use of aliases to refer to functions with different names inside a flow</li>
<li>Connections between flows, functions and values</li>
</ul>
<h1 id="functions-diagram-5"><a class="header" href="#functions-diagram-5">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/mandlebrot/functions.dot.svg" target="_blank"><img src="flowsamples/mandlebrot/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="factorial-1"><a class="header" href="#factorial-1">factorial</a></h1>
<h1 id="description-7"><a class="header" href="#description-7">Description</a></h1>
<p>A flow that calculates the matrix product of two matrices.</p>
<h1 id="context-diagram-6"><a class="header" href="#context-diagram-6">Context Diagram</a></h1>
<p><a href="flowsamples/matrix_mult/root.dot.svg" target="_blank"><img src="flowsamples/matrix_mult/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used-6"><a class="header" href="#features-used-6">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Connections between functions</li>
<li>Loop-back connections to accumulate an array, used to gather Numbers into array/number and then array/number into
array/array/number (i.e. Matrix)</li>
<li>Initializing function inputs with values, once and constantly</li>
<li>Multiple connections into and out of functions</li>
<li>Library Functions <code>to_json</code>, <code>multiply</code>, <code>subtract</code> from <code>flowstdlib</code></li>
<li>Library Functions <code>tap</code>, <code>compare</code> from <code>flowstdlib</code></li>
<li>Use of aliases to refer to functions with different names inside a flow</li>
<li>Automatic array decomposing into the elements the array holds when target function input does not accept the array type</li>
</ul>
<h1 id="functions-diagram-6"><a class="header" href="#functions-diagram-6">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/matrix_mult/functions.dot.svg" target="_blank"><img src="flowsamples/matrix_mult/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pipeline"><a class="header" href="#pipeline">pipeline</a></h1>
<h1 id="description-8"><a class="header" href="#description-8">Description</a></h1>
<p>A sample that shows a simple &quot;pipeline flow&quot; with a number of functions organized into a
pipeline. When supplied with a &quot;stream&quot; of inputs, multiple functions are able to run in
parallel utilizing more than one core on the machine.</p>
<p>Using command line options (-j, -t) the flow can be invoked with just one worker thread and it 
becomes sequential. The metrics of how many jobs were able to be processed in parallel can
be viewed using the -m command line option.</p>
<h1 id="context-diagram-7"><a class="header" href="#context-diagram-7">Context Diagram</a></h1>
<p><a href="flowsamples/pipeline/root.dot.svg" target="_blank"><img src="flowsamples/pipeline/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used-7"><a class="header" href="#features-used-7">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Setting initial value of a Value at startup</li>
<li>Multiple connections into and out of functions and values</li>
<li>Library Functions used from <code>flowstdlib</code></li>
<li>Use of aliases to refer to functions with different names</li>
<li>Connections between functions and values</li>
<li>Referring to a function's input by name in connections</li>
</ul>
<h1 id="functions-diagram-7"><a class="header" href="#functions-diagram-7">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/pipeline/functions.dot.svg" target="_blank"><img src="flowsamples/pipeline/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prime"><a class="header" href="#prime">prime</a></h1>
<p>WIP</p>
<h1 id="description-9"><a class="header" href="#description-9">Description</a></h1>
<p>A flow that finds prime numbers upto the maximum specified in the input arguments</p>
<h1 id="context-diagram-8"><a class="header" href="#context-diagram-8">Context Diagram</a></h1>
<p><a href="flowsamples/prime/root.dot.svg" target="_blank"><img src="flowsamples/prime/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used-8"><a class="header" href="#features-used-8">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Subflows</li>
<li>Value (with an initial value set)</li>
<li>Constant Value</li>
<li>Arguments parsing for the execution</li>
<li>Constant Value used</li>
<li>Connections between functions</li>
<li>Library Functions used
<ul>
<li><code>Args</code> to parse arguments</li>
<li><code>sequence</code> to generate a sequence of numbers</li>
<li><code>divide</code> to divide two numbers</li>
<li><code>compare</code> function to produce outputs based on comparing two input values</li>
<li><code>switch</code> function to stop or pass a data flow based on another one</li>
<li><code>ToString</code> to convert Numbers to Strings</li>
<li><code>stdout</code> to print a String to standard output</li>
</ul>
</li>
</ul>
<h1 id="functions-diagram-8"><a class="header" href="#functions-diagram-8">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/prime/functions.dot.svg" target="_blank"><img src="flowsamples/prime/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="primitives"><a class="header" href="#primitives">primitives</a></h1>
<h1 id="description-10"><a class="header" href="#description-10">Description</a></h1>
<p>A flow that takes a value and a constant and adds them, and then takes the result and adds 
it to the constant again and then printed the final value to stdout. It also uses the switch function
to stop a flow with a false value, and compares the result of the add to a value and print out to stdout
if it is greater or equal to it.</p>
<p>The purpose is not to do anything useful, but just to show the use of and stress the semantics 
of a number of the primitives.</p>
<h1 id="context-diagram-9"><a class="header" href="#context-diagram-9">Context Diagram</a></h1>
<p><a href="flowsamples/primitives/root.dot.svg" target="_blank"><img src="flowsamples/primitives/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used-9"><a class="header" href="#features-used-9">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Library Functions used (<code>add</code> and <code>stdout</code> from <code>flowstdlib</code>)</li>
<li>Value used (with an initial value set)</li>
<li>Constant Value used</li>
<li>Connections between functions</li>
<li>Two functions of the same name in the same flow, distinguished by <code>alias</code></li>
<li><code>switch</code> function to stop or pass a data flow based on another one</li>
<li><code>compare</code> function to produce outputs based on comparing two input values</li>
</ul>
<h1 id="functions-diagram-9"><a class="header" href="#functions-diagram-9">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/primitives/functions.dot.svg" target="_blank"><img src="flowsamples/primitives/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="reverse-echo"><a class="header" href="#reverse-echo">reverse-echo</a></h1>
<h1 id="description-11"><a class="header" href="#description-11">Description</a></h1>
<p>Trivial flow that takes a line on <code>stdin</code>, reverses it and then prints it on <code>stdout</code></p>
<h1 id="context-diagram-10"><a class="header" href="#context-diagram-10">Context Diagram</a></h1>
<p><a href="flowsamples/reverse-echo/root.dot.svg" target="_blank"><img src="flowsamples/reverse-echo/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used-10"><a class="header" href="#features-used-10">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Library Functions used (<code>stdin</code> and <code>stdout</code> from <code>flowstdlib</code>)</li>
<li>Custom function (in rust) with a structure on the output with sub-elements</li>
<li>Connections between functions</li>
<li>Connections from sub-elements of a function's output</li>
<li>Function with single input (stdout) not requiring input name</li>
</ul>
<h1 id="functions-diagram-10"><a class="header" href="#functions-diagram-10">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/reverse-echo/functions.dot.svg" target="_blank"><img src="flowsamples/reverse-echo/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="router"><a class="header" href="#router">router</a></h1>
<h1 id="description-12"><a class="header" href="#description-12">Description</a></h1>
<p>This sample implements the algorithm (as described here https://github.com/andrewdavidmackenzie/router) for
calculating the shortest route from a start-point to an end-point through a simplified road 
network.</p>
<p><img src="flowsamples/router/LHR_to_LON.png" alt="Road route London Heathrow to City Center" /></p>
<h1 id="context-diagram-11"><a class="header" href="#context-diagram-11">Context Diagram</a></h1>
<p><a href="flowsamples/router/root.dot.svg" target="_blank"><img src="flowsamples/router/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used-11"><a class="header" href="#features-used-11">Features Used</a></h1>
<ul>
<li>The selection of a single Value from an array of values that is one of a number of outputs (not the only 
output). This involves selecting the structure from the output by route, and then the value from that by index. </li>
</ul>
<h1 id="functions-diagram-11"><a class="header" href="#functions-diagram-11">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/router/functions.dot.svg" target="_blank"><img src="flowsamples/router/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sequence"><a class="header" href="#sequence">sequence</a></h1>
<h1 id="description-13"><a class="header" href="#description-13">Description</a></h1>
<p>A flow that generates a sequence of output numbers in a range between two input numbers</p>
<h1 id="context-diagram-12"><a class="header" href="#context-diagram-12">Context Diagram</a></h1>
<p><a href="flowsamples/sequence/root.dot.svg" target="_blank"><img src="flowsamples/sequence/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used-12"><a class="header" href="#features-used-12">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Value used (with an initial value set)</li>
<li>Constant Value used</li>
<li>Connections between functions</li>
<li>Two functions of the same name in the same flow, distinguished by <code>alias</code></li>
<li>Library Functions used
<ul>
<li><code>add</code> to add numbers</li>
<li><code>ToString</code> to convert Numbers to Strings</li>
<li><code>stdout</code> to print a String to standard output</li>
<li><code>switch</code> function to stop or pass a data flow based on another one</li>
<li><code>compare</code> function to produce outputs based on comparing two input values</li>
</ul>
</li>
</ul>
<h1 id="functions-diagram-12"><a class="header" href="#functions-diagram-12">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/sequence/functions.dot.svg" target="_blank"><img src="flowsamples/sequence/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="range-of-ranges"><a class="header" href="#range-of-ranges">range-of-ranges</a></h1>
<h1 id="description-14"><a class="header" href="#description-14">Description</a></h1>
<p>A flow that generates a range of numbers, and for each of them generates a range from 1 upto the numner.
This is intended as a test case for an issue with two linked flows like 'sequence' that can lead to a deadlock</p>
<h1 id="context-diagram-13"><a class="header" href="#context-diagram-13">Context Diagram</a></h1>
<p><a href="flowsamples/sequence-of-sequences/root.dot.svg" target="_blank"><img src="flowsamples/sequence-of-sequences/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used-13"><a class="header" href="#features-used-13">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Library Functions used (<code>stdout</code> from <code>flowstdlib</code>)</li>
<li>Library Flows used (<code>sequence</code> from <code>flowstdlib</code>)</li>
<li>Connections between functions</li>
</ul>
<h1 id="functions-diagram-13"><a class="header" href="#functions-diagram-13">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/sequence-of-sequences/functions.dot.svg" target="_blank"><img src="flowsamples/sequence-of-sequences/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tokenizer"><a class="header" href="#tokenizer">tokenizer</a></h1>
<h1 id="description-15"><a class="header" href="#description-15">Description</a></h1>
<p>Sample to show the possible parallelization (depending on the runtime implementation) of splitting a string into
tokens using the string splitter function from the flowstdlib.</p>
<h1 id="context-diagram-14"><a class="header" href="#context-diagram-14">Context Diagram</a></h1>
<p><a href="flowsamples/tokenizer/root.dot.svg" target="_blank"><img src="flowsamples/tokenizer/root.dot.svg"></a></p>
<p>Click image to navigate flow hierarchy.</p>
<h1 id="features-used-14"><a class="header" href="#features-used-14">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Setting initializer of a Function's input with a constant initializer</li>
<li>Library Functions</li>
<li>Iteration (possibly in parallel) via feedback of partial output values back to the same funtion's input.</li>
<li>Implicit conversion between arrays of string and string done by run-time, in feedbak loop to the same process</li>
</ul>
<h1 id="functions-diagram-14"><a class="header" href="#functions-diagram-14">Functions Diagram</a></h1>
<p>This diagram shows the exploded diagram of all functions in all flows, and their connections.
<a href="flowsamples/tokenizer/functions.dot.svg" target="_blank"><img src="flowsamples/tokenizer/functions.dot.svg"></a></p>
<p>Click image to view functions graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="developing-flow"><a class="header" href="#developing-flow">Developing flow</a></h2>
<h3 id="supported-operating-systems"><a class="header" href="#supported-operating-systems">Supported Operating Systems</a></h3>
<p>The CI tests for 'flow' run on Mac OS X and Linux. Others may well work as rust projects are pretty 
portable but I develop on Mac OS X and don't know the status on other OS.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="pre-requisites-required-to-build-and-test"><a class="header" href="#pre-requisites-required-to-build-and-test">Pre-requisites required to build and test</a></h2>
<p>These are the pre-requisites that are required to build and test 'flow':</p>
<ul>
<li>rust toolchain (<code>rustup</code>, <code>cargo</code>, <code>rustc</code>, etc )
<ul>
<li>with <code>wasm32-unknown-unknown</code> target for compiling to wasm</li>
<li><code>clippy</code> for checking coding best practices</li>
</ul>
</li>
<li><code>zmq</code> (Zero Message Queue) library</li>
<li><code>graphviz</code> utilities for automatic generation of SVG files for docs</li>
</ul>
<p>For building the guide:
<code>mdbook</code> and the <code>mdbook-linkcheck</code> plug-in</p>
<h2 id="installing-pre-requisites"><a class="header" href="#installing-pre-requisites">Installing pre-requisites</a></h2>
<p>You have to install rustup, cargo and rust toolchain yourself.
I decided to stop short of futzing with people's installed toolchains.</p>
<p>There is a Makefile target <code>config</code> that will install the other dependencies:</p>
<ul>
<li><code>make config</code></li>
</ul>
<p>That will add the <code>wasm32-unknown-unknown</code> target, <code>clippy</code>, <code>graphviz</code>, <code>mdbook</code> and <code>mdbook-linkcheck</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flowcore"><a class="header" href="#flowcore"><code>flowcore</code></a></h1>
<p>See also: <a href="http://andrewdavidmackenzie.github.io/flow/code/doc/flowcore/index.html">Code docs</a></p>
<p><code>flowcore</code> is a library of core structs and traits related to flow that is shared between multiple flow
crates, and separate to avoid a cyclic dependency.</p>
<h1 id="flow_impl"><a class="header" href="#flow_impl"><code>flow_impl</code></a></h1>
<p>This is a trait that implementations of flow 'functions' must implement in order for them to be invoked
by the flowrlib (or other) run-time library.</p>
<p>An example of a function implementing the <code>Implementation</code> trait can be found in the
docs for <a href="http://andrewdavidmackenzie.github.io/flow/code/doc/flowcore/trait.Implementation.html"><code>Implementation</code></a></p>
<h1 id="provider"><a class="header" href="#provider"><code>provider</code></a></h1>
<p>This implements a <code>content provider</code> that resolves URLs and then gets the content of the url.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flowmacro"><a class="header" href="#flowmacro"><code>flowmacro</code></a></h1>
<p>See also: <a href="http://andrewdavidmackenzie.github.io/flow/code/doc/flowmacro/index.html">Code docs</a></p>
<p>Flow is an attribute macro to be used on the structure that provides an implementation for a function (by implementing
the <code>FlowImpl</code> trait), so that when compiled for the <code>wasm32</code> target, code is inserted to help read the inputs,
help form the outputs and allocate memory (<code>alloc</code>) as well as serialize and deserialize the data passed across the 
native/wasm boundary.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flowc"><a class="header" href="#flowc"><code>flowc</code></a></h1>
<p>See also: <a href="http://andrewdavidmackenzie.github.io/flow/code/doc/flowc/index.html">Code docs</a></p>
<p><code>flowc</code> is the &quot;compiler and linker&quot; for flows and flow libraries, although it is not 
very similar to what you might be familiar with as a compiler or linker.</p>
<p>It loads flow definition files, and builds the flow hierarchy reading from referenced
flows/functions and library references, and builds the flow in memory.</p>
<p>Then it connects all functions via data flows through the hierarchy and removes most of the
flow structure leaving a &quot;network of functions&quot; which it then optimizes (removing
unused functions and connections).</p>
<p>It checks that types match and required connections exist. </p>
<p>It also checks for some illegal or cases that would prove problematic at runtime
(specific types of &quot;loops&quot; or contention for a connection)</p>
<p>Lastly it generates a manifest describing the flow, which can be executed by <code>flowr</code>.</p>
<p>It then may (depending on the command line options used) invoke <code>flowr</code> (using cargo to ensure
it is up to date and built).</p>
<h1 id="flowclib"><a class="header" href="#flowclib"><code>flowclib</code></a></h1>
<p>This library contains most of the compilation and linking logic for <code>flowc</code>. </p>
<p>See also: <a href="http://andrewdavidmackenzie.github.io/flow/code/doc/flowclib/index.html">Code docs</a></p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="test-flows"><a class="header" href="#test-flows">Test flows</a></h2>
<p>These are a number of test flows to exercise specific features and are not intended to be &quot;real world programs&quot; 
or solutions to problems.</p>
<p>They are contained in the <a href="https://github.com/andrewdavidmackenzie/flow/tree/master/flowc/tests/test-flows">flowc/tests/test-flows</a>
folder in the code.</p>
<h3 id="structure-of-each-test"><a class="header" href="#structure-of-each-test">Structure of each test</a></h3>
<p>Each test flow of name 'text-name' is in its own folder, which includes:</p>
<ul>
<li>A <code>test-name.toml</code> file that contains the flow description</li>
<li>Files used in the automated testing of each sample:
<ul>
<li><code>test-name.args</code> the arguments to be passed to the flow when running it</li>
<li><code>test-name.stdin</code> the input supplied to the flow on standard input when running it</li>
<li><code>test-name.expected</code> the output that the flow is expected to produce when invoked with 
<code>test-name.args</code> as command line arguments (via <code>flowr</code>) and <code>test-name.stdin</code> 
sent to standard input</li>
</ul>
</li>
</ul>
<h3 id="execution-of-each-test"><a class="header" href="#execution-of-each-test">Execution of each test</a></h3>
<ul>
<li>The test flow will be compiled by <code>flowc</code> and the manifest generated in a file names <code>test-name.json</code></li>
<li>The <code>test-name.json</code> manifest will be executed by <code>flowr</code>, passing <code>test-name.args</code> as it's arguments
and piping the contents of <code>test-name.stdin</code> to standard input, and standard output of the flow execution will 
be captured.</li>
<li>The standard output will be compared to <code>test-name.expected</code> and if identical the test will pass.
Any differences and the test will fail.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hello-world-simple"><a class="header" href="#hello-world-simple">hello-world-simple</a></h1>
<h1 id="description-16"><a class="header" href="#description-16">Description</a></h1>
<p>The simplest possible &quot;Hello World!&quot; example with 'flow'.</p>
<h1 id="features-used-15"><a class="header" href="#features-used-15">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>A String value that is initialized at start-up</li>
<li>Context Functions used (<code>stdout</code> from <code>context</code>)</li>
<li>A connection between the value and the function</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="line-echo"><a class="header" href="#line-echo">line-echo</a></h1>
<h1 id="description-17"><a class="header" href="#description-17">Description</a></h1>
<p>A trivial flow that takes a line on <code>stdin</code>, and prints it on <code>stdout</code></p>
<h1 id="features-used-16"><a class="header" href="#features-used-16">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Library Functions used (<code>stdin</code> and <code>stdout</code> from <code>context</code>)</li>
<li>Connections between functions</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="print-args"><a class="header" href="#print-args">print-args</a></h1>
<h1 id="description-18"><a class="header" href="#description-18">Description</a></h1>
<p>A flow that takes the arguments passed to the flow on the command line and prints 
the first one (after the flow's source URL) out on standard output</p>
<h1 id="features-used-17"><a class="header" href="#features-used-17">Features Used</a></h1>
<ul>
<li>Context Flow</li>
<li>Library Functions used (<code>args</code> and <code>stdout</code> from <code>context</code>)</li>
<li>Connections between functions</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="important-make-targets"><a class="header" href="#important-make-targets">Important make targets</a></h2>
<ul>
<li>(default) <code>make</code> will build, run local tests and generate docs.</li>
<li><code>make build-guide</code> will just generate the HTML for the guide if you are writing docs. But better
would be to just <code>cd guide &amp;&amp; mdbook serve</code> as that will track and update the generated content as 
you make changes, allowing you to view them instantly with a browser refresh.</li>
<li><code>make test</code> this should be what you run to check changes you have made work OK. At the moment it is the 
same as 'make travis' until I re-instate some tests I was having issues with.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="contributing"><a class="header" href="#contributing">Contributing</a></h2>
<p>There are many ways of contributing</p>
<ul>
<li>adding an issue with a bug report of an enhancement request or new feature idea</li>
<li>pick up a <a href="https://github.com/andrewdavidmackenzie/flow/issues?q=is%3Aissue+is%3Aopen+label%3A%22help+wanted%22">help wanted</a> issue and try and fix it</li>
<li>adding to or correcting the docs and this guide</li>
<li>adding a new sample</li>
<li>improvements to the libraries, compiler, standard library, run-time</li>
<li>improvements to unit or integration tests</li>
<li>improvements to build processes (e.g. getting coverage reports working etc)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h3 id="issues"><a class="header" href="#issues">Issues</a></h3>
<p>Issues can be found in the <a href="https://github.com/andrewdavidmackenzie/flow/issues">repo</a>, if you are not yet a 
project contributor then just add a comment to one to say you'd like to work on it and I will avoid doing
the same. </p>
<p>I work on issues KanBan style in this <a href="https://github.com/andrewdavidmackenzie/flow/projects/2">Github Project</a></p>
<p>Adding new issues you find can also be helpful, although with my limited time on the project, fixing issues
and sending PRs are more welcome! :-)</p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="prs"><a class="header" href="#prs">PRs</a></h3>
<p>If you want to contribute a code or test or docs or tolling change....</p>
<ul>
<li>if no existing issue exists for it, create one so we can agree on what to do before starting (a good idea 
to make later PR merges easier to accept I think!)</li>
<li>if an issue exists already add a comment to it so I know you want to work on it</li>
<li>fork the repo</li>
<li>create a branch for the issue in your repo</li>
<li>make your changes and update tests, docs and samples as required</li>
<li>run tests ('make travis') before pushing to your branch</li>
<li>wait for Travis to pass</li>
<li>submit the PR, referencing the issue is a good idea</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sample-flows-1"><a class="header" href="#sample-flows-1">Sample flows</a></h1>
<p>This crate and folder contains a number of sample 'flows' that have been developed during the development
of the compiler and the run-time to drive the project development and demonstrate it working. </p>
<p>They also serve as a type of regression test to make sure we don't break any of the 
semantics that the samples rely on.</p>
<p>They range from the extremely simple &quot;hello-world&quot; example to more complex ones like generation of
a fibonacci series or a mandlebrot set image.</p>
<h2 id="structure-of-each-sample-1"><a class="header" href="#structure-of-each-sample-1">Structure of each sample</a></h2>
<p>Each sample directory contains:</p>
<ul>
<li>A <code>DESCRIPTION.md</code> file that:
<ul>
<li>describes what the <code>Flow</code> does</li>
<li>lists the features of <code>flow</code> that this sample uses and demonstrates</li>
</ul>
</li>
<li>A <code>root.toml</code> file that is the root file of the flow description</li>
<li>Files used in the automated testing of each sample:
<ul>
<li><code>test_arguments.txt</code> the arguments to be passed to the flow when running it</li>
<li><code>test_input.txt</code> the input supplied to the flow when running it</li>
<li><code>expected_output.txt</code> the output that the flow is expected to produce when invoked with 
<code>text_arguments.txt</code> and input <code>test_input.txt</code></li>
</ul>
</li>
</ul>
<h2 id="compiling-the-samples-1"><a class="header" href="#compiling-the-samples-1">Compiling the Samples</a></h2>
<p>The samples set has now been converted to a rust crate with a custom build script.</p>
<p>There is no dependency declared in Cargo.toml on the other crates (as you cannot currently declare a
dependency on a binary, just a lib), but in order to build, test and run this crate/folder you will need <code>flowc</code>
and <code>flowr</code> installed and on <code>$PATH</code> in order for build scripts to find them.</p>
<p>Using <code>cargo build -p flowsamples</code> causes the build script to run, and it compiles in-place the samples
using the <code>flowc</code> compiler.</p>
<h2 id="running-the-samples-1"><a class="header" href="#running-the-samples-1">Running the Samples</a></h2>
<p>Using <code>cargo run -p flowsamples</code> causes the sample runner in main.rs to run. It looks for sub-folders in
the samples folder and then executes the sample within. </p>
<p>When running them, it uses:</p>
<ul>
<li>test.arguments - arguments passed to the flow on the command line when executing it</li>
<li>test.input - test input to send to the sample flow using STDIN</li>
</ul>
<p>The output is sent to standard output.</p>
<p>To run a specific sample only use <code>cargo run -p flowsamples {sample-name}</code></p>
<h2 id="testing-the-samples-1"><a class="header" href="#testing-the-samples-1">Testing the Samples</a></h2>
<p>You can test all samples by using <code>cargo test -p flowsamples</code>,
it will run each one in turn with the pre-defined arguments and standard input.</p>
<p>It also gathers the standard output, standard error and files generated and checks for correctness 
by comparing them to previously generated content distributed with the package.</p>
<ul>
<li>If there is any standard error found in the file test.err then the test will fail.</li>
<li>If there is no standard error then it compares standard output captured in test.output to expected.output
and fails if there is a difference.</li>
<li>If an expected.file exists then it compares it to file output in test.file and fails if there is any 
difference with the expected file.</li>
</ul>
<pre><code>cargo test -p flowsamples 
    Finished test [unoptimized + debuginfo] target(s) in 0.11s
     Running target/debug/deps/samples-9e024e2c420db146

running 16 tests
test test::test_all_samples ... ignored
test test::test_args ... ok
test test::test_arrays ... ok
test test::test_factorial ... ok
test test::test_fibonacci ... ok
test test::test_hello_world ... ok
test test::test_mandlebrot ... ok
test test::test_matrix_mult ... ok
test test::test_pipeline ... ok
test test::test_prime ... ok
test test::test_primitives ... ok
test test::test_sequence ... ok
test test::test_sequence_of_sequences ... ok
test test::test_reverse_echo ... ok
test test::test_router ... ok
test test::test_tokenizer ... ok

test result: ok. 15 passed; 0 failed; 1 ignored; 0 measured; 0 filtered out
</code></pre>
<p>NOTE: Until multiple instances of the client/server pair for running flows can be run at once, we 
need to restrict the test framework to only run one test at a time, otherwise by default it will run
multiple tests at once, and some will fail.</p>
<p>NOTE: At the moment, to make the progress more visible, each sample has a test manually added to it
in <code>samples/main.rs</code>, so for a new sample a test needs to be added by the author.</p>
<p>To test just one sample use <code>cargo test -p flowsamples {test-name}</code></p>
<pre><code>cargo test -p flowsamples test_factorial
    Finished test [unoptimized + debuginfo] target(s) in 0.12s
     Running target/debug/deps/samples-9e024e2c420db146

running 1 test
test test::test_factorial ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 15 filtered out
</code></pre>
<h2 id="default-workspace-member-crate-1"><a class="header" href="#default-workspace-member-crate-1">Default workspace member crate</a></h2>
<p>The <code>samples</code> crate is one of the <code>default-members</code> of the <code>flow</code> workspace project, so it is used if no 
particular package is supplied, thus the samples can also be built and run using:</p>
<ul>
<li><code>cargo build</code> : compile the samples using <code>flowc</code></li>
<li><code>cargo run</code>   : run the samples using <code>flowr</code></li>
<li><code>cargo test</code>  : run the samples using <code>flowr</code> and check the generated output is correct</li>
</ul>
<p>As other <code>default-members</code> are added to the workspace over time, those commands may do other things, so
just be aware that if you only want to run the samples the <code>-p samples</code> option above will be safer.</p>
<h2 id="flowsamples-executable-1"><a class="header" href="#flowsamples-executable-1"><code>flowsamples</code> executable</a></h2>
<p>There is also an executable (<code>bin</code> or binary) installed with the library called <code>flowsamples</code> that if run
without any arguments will run all the samples. You can supply it the name of a sample (the name of the folder
under <code>samples</code> where the sample is) to run just that one sample.</p>
<h2 id="developing-a-new-sample-1"><a class="header" href="#developing-a-new-sample-1">Developing a new sample</a></h2>
<p>To develop a new sample, just create a new folder under 'samples' with your sample name. </p>
<p>Add the root.toml and any other included flows and describe them.</p>
<p>Add a DESCRIPTION.md file that describes what the sample does and what features of flow it uses.</p>
<p>Add an entry in the guide's &quot;samples&quot; section that will include the DESCRIPTION.md file above.</p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="continuous-integration-testing-of-flow"><a class="header" href="#continuous-integration-testing-of-flow">Continuous Integration testing of flow</a></h3>
<p>The CI build and test run in Travis on each push to a branch or PR can be run locally 
using <code>make travis</code>.</p>
<p>These tests include unit and integration tests, rust doc-tests and it also compiles, generates, runs and checks the 
output of all the samples found in the ./samples folder.</p>
<p>This will also rebuild the guide locally.</p>
<p>I recommend to make sure this runs without errors and passes before pushing to GitHub.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="internals-overview"><a class="header" href="#internals-overview">Internals Overview</a></h2>
<p>In this section we provide some more details on what flowc does when you use it to compile, generate, build and run a flow.</p>
<p>The process includes these areas described in more detail in the following pages:</p>
<ul>
<li>Flow loading: the process of reading in the flow description and building an internal representation of it</li>
<li>Flow compiling: take hierarchical flows representation loaded from previous stage and &quot;compile down&quot; to one more 
suited for project for flow project generation for execution.</li>
<li>Flow execution: The generated project is loaded by the generic run-time library (flowrlib) and the functions are executed in turn.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="flow-loading"><a class="header" href="#flow-loading">Flow Loading</a></h2>
<p>Read in the hierarchical definition, recursively reading all nested flows until everything loaded.</p>
<p>Build the connections between values, functions, input and outputs using the 
unaliased routes to functions and subflows.</p>
<p>Check that the from/to types on connections match.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="flow-compiling"><a class="header" href="#flow-compiling">Flow Compiling</a></h2>
<p>From the hierarchical definition of a flow program produced by the loading stage:</p>
<h3 id="connection-reducing"><a class="header" href="#connection-reducing">Connection Reducing</a></h3>
<p>Build a flat table of connections.</p>
<p>For every connection that ends at a flow:</p>
<ul>
<li>Look through all other connections and for each one that starts where this flow starts:
<ul>
<li>Replace the connection's destination with this connections destination.</li>
<li>Delete this connection</li>
</ul>
</li>
</ul>
<p>When done there should be no connections ending at flows.
Any connections left that starts at a flow, is unconnected and can be deleted.</p>
<h3 id="value-and-function-tables"><a class="header" href="#value-and-function-tables">Value and Function Tables</a></h3>
<p>Build a table of values and functions.</p>
<h3 id="pruning-value-and-function-tables"><a class="header" href="#pruning-value-and-function-tables">Pruning Value and Function Tables</a></h3>
<p>Drop the following combinations, with warnings:</p>
<ul>
<li>values that don't have connections from them.</li>
<li>values that have only outputs and are not initialized.</li>
<li>functions that don't have connections from their output.</li>
<li>functions that don't have connections to all their inputs.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="flow-execution"><a class="header" href="#flow-execution">Flow Execution</a></h2>
<h3 id="lazy-execution"><a class="header" href="#lazy-execution">Lazy Execution</a></h3>
<p>Execution should be as lazy as possible.</p>
<p>The only thing that determines if a function is run is the availability at its inputs of the data
for the run, and the ability to produce the result at its output by having the output free.</p>
<p>If the output is free because a second function is running and hasn't consumed its input, then 
the first function will be blocked and computing resources will be used on the functions that most 
need it. When they complete and produce an output, that output may satisfy another functions' 
inputs which in turn will run, and so on and so forth.</p>
<h3 id="execution-states"><a class="header" href="#execution-states">Execution States</a></h3>
<p>Functions can be in one of two states:</p>
<ul>
<li>blocked (either input is pending or output is blocked)</li>
<li>ready (inputs are satisfied, output is free and it can be run anytime)</li>
</ul>
<h3 id="value-rules"><a class="header" href="#value-rules">Value Rules</a></h3>
<p>A Value has only one input, but that can be connected to a value offered by multiple &quot;writers&quot;.
It has only one output, but that can be connected to and listened on by multiple &quot;listeners&quot;</p>
<p>It stores a value, that can be initialized when the program is loaded to an initial value.</p>
<p>When the value is empty it can be updated.
When it is updated, the value is made available to all &quot;listeners&quot; at its output.
While it stores a value, it cannot be updated, and any writer will be blocked until the value is 
consumed and can be updated again.</p>
<p>Each of the listeners can read or &quot;consume&quot; the value once.</p>
<p>When it has been consumed by all listeners, the value becomes empty (<code>None</code>) and can be updated again.
It does not become empty until all listeners have consumed the value.</p>
<p>You can think of Values as a FIFO of size 1 for each listener connected to it.</p>
<h3 id="function-rules"><a class="header" href="#function-rules">Function Rules</a></h3>
<p>The operation of a Function is similar to that of a value, except that it can have multiple inputs
and it is not run until they are all satisfied.</p>
<p>A function does not store any value or state, beyond making it's output available to listeners
asynchronously.</p>
<p>A Function can have zero or more inputs. 
Each input can be connected to and written to by multiple &quot;writers&quot;.
It has only one output, but that can be connected to and listened to by multiple &quot;listeners&quot;.</p>
<p>A Function can only run when a value is available at each of it's inputs and it's output is 
free to write to.. It is blocked from running until these conditions are met.</p>
<p>When a function runs, it produces an output that is made available to all &quot;listeners&quot; at it's output.</p>
<p>Each of the listeners can read or &quot;consume&quot; the output value once.</p>
<h3 id="generalized-rules"><a class="header" href="#generalized-rules">Generalized Rules</a></h3>
<p>If we consider a value to be like a null function that does no calculation, but just passes the input 
value to it's outputs - then we can state some general rules that apply to the &quot;running&quot; of both.</p>
<ul>
<li>Can have zero or more inputs (max 1 for a Value)</li>
<li>Each input can be connected to and values offered to it by multiple &quot;writers&quot;.</li>
<li>Has one output, that can be listened on by multiple &quot;listeners&quot;.</li>
<li>Can only be run (updated) when a value is available at each of the inputs and the output is 
free to write to. Is blocked from running until these conditions are met.</li>
<li>When ran, it produces an output that is made available to all &quot;listeners&quot; at its output.</li>
<li>Each of the listeners can read or &quot;consume&quot; the output value only once.</li>
<li>Once the output has been consumed (once) by all of the listeners, then the output is free to be
written again.</li>
</ul>
<h2 id="execution-process"><a class="header" href="#execution-process">Execution Process</a></h2>
<h3 id="loading"><a class="header" href="#loading">Loading</a></h3>
<p>All functions and values are loaded.</p>
<h3 id="initialization"><a class="header" href="#initialization">Initialization</a></h3>
<p>Any values with initial values are initialized with them and hence make them available on their 
output, and hence they are made available on the input of all connected objects (values and functions).</p>
<p>Now, the execution loop can be started.</p>
<h3 id="execution-loop-1"><a class="header" href="#execution-loop-1">Execution Loop</a></h3>
<p>Next ready Function is run</p>
<ul>
<li>Next function on the read list is run
<ul>
<li>this consumes all its inputs
<ul>
<li>this may unblock another function which was blocked sending to this functions as it's input was full</li>
</ul>
</li>
</ul>
</li>
<li>Any data produced is made available on the output</li>
<li>Outputs are made available to all connected inputs on other functions
<ul>
<li>The data on any output is made available to all connected inputs, copied if necessary to multiple.</li>
<li>This may satisfy the inputs of the other function, causing it to be added to the ready list</li>
</ul>
</li>
</ul>
<h3 id="parallel-execution"><a class="header" href="#parallel-execution">Parallel Execution</a></h3>
<p>A core goal of 'flow' is to enable parallel execution of programs, with the parallelism being described
inherently in the flow description, via data dependencies and functions with zero side effects.</p>
<p>Currently, the run-time only executes one function at a time, but that is destined to change as soon
as it can be implemented, both in multiple threads in the same process on one machine, then multiple
processes on one machine and then across machines across a network.</p>
<h3 id="termination"><a class="header" href="#termination">Termination</a></h3>
<p>The execution of a flow terminates when there are no functions left on the ready list</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
